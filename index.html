<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta name="referrer" content="no-referrer">
    <meta name="description" content="Odin for Azure Local - Optimal Deployment and Infrastructure Navigator">
    <meta name="keywords" content="Azure Local, Azure Stack HCI, Network Architecture, ARM Templates, Odin">
    <title>Odin for Azure Local</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <!-- Segoe UI is a Windows system font - no Google Fonts import needed -->
    <link rel="stylesheet" href="css/style.css">
    <style>
        .reset-button {
            width: 100%;
            padding: 0.8rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            color: var(--text-secondary);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 500;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 1.5rem;
        }

        .reset-button:hover {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(185, 28, 28, 0.3));
            color: #fff;
            border-color: rgba(239, 68, 68, 0.5);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.2);
        }

        .reset-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(239, 68, 68, 0.1);
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.3), rgba(185, 28, 28, 0.4));
        }

        .sdn-feature-card {
            display: flex;
            align-items: flex-start;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .sdn-feature-card:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: var(--accent-blue);
        }

        .sdn-feature-card input[type="checkbox"] {
            cursor: pointer;
            width: 18px;
            height: 18px;
            margin-top: 2px;
        }

        /* Tab Navigation System */
        .odin-tab-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: var(--nav-bg, linear-gradient(180deg, rgba(17, 17, 17, 0.98) 0%, rgba(17, 17, 17, 0.95) 100%));
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--glass-border);
            padding: 0 24px;
        }

        .odin-tab-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            gap: 8px;
            height: 56px;
        }

        .odin-tab-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            padding-right: 24px;
            border-right: 1px solid var(--glass-border);
            margin-right: 16px;
        }

        .odin-tab-logo img {
            width: 32px;
            height: 32px;
        }

        .odin-tab-logo span {
            font-weight: 600;
            font-size: 16px;
            color: var(--text-primary);
        }

        .odin-tab-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s ease;
            position: relative;
            text-decoration: none;
        }

        .odin-tab-btn:hover {
            background: var(--nav-hover-bg, rgba(255, 255, 255, 0.05));
            color: var(--text-primary);
        }

        .odin-tab-btn.active {
            background: var(--nav-active-bg, rgba(0, 120, 212, 0.15));
            color: var(--accent-blue);
        }

        .odin-tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 3px;
            background: var(--accent-blue);
            border-radius: 3px 3px 0 0;
        }

        .odin-tab-btn svg {
            width: 18px;
            height: 18px;
        }

        .odin-tab-badge {
            padding: 2px 8px;
            background: rgba(139, 92, 246, 0.2);
            color: var(--accent-purple);
            font-size: 10px;
            font-weight: 600;
            border-radius: 10px;
            text-transform: uppercase;
        }

        /* Theme toggle in nav */
        .nav-theme-toggle {
            padding: 6px 12px;
            background: var(--subtle-bg);
            border: 1px solid var(--glass-border);
            color: var(--text-primary);
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-left: auto;
            transition: all 0.2s;
        }

        .nav-theme-toggle:hover {
            background: var(--subtle-bg-hover);
        }

        /* Mobile nav: hide text labels, show only icons */
        @media (max-width: 768px) {
            .odin-tab-nav {
                padding: 0 8px;
            }

            .odin-tab-container {
                gap: 4px;
            }

            .odin-tab-logo {
                padding-right: 8px;
                margin-right: 4px;
                gap: 6px;
            }

            .odin-tab-logo span {
                display: none;
            }

            .odin-tab-btn {
                padding: 8px 10px;
                font-size: 0;
                gap: 0;
            }

            .odin-tab-btn svg {
                width: 20px;
                height: 20px;
            }

            .odin-tab-badge {
                display: none;
            }

            .nav-theme-toggle {
                padding: 6px 8px;
                font-size: 14px;
            }

            /* Hide the "Feedback" text, keep emoji */
            .nav-feedback-text {
                display: none;
            }
        }

        /* Adjust body padding for fixed nav */
        body.has-tab-nav {
            padding-top: 56px;
        }

        /* Tab content sections */
        .odin-tab-content {
            display: none;
        }

        .odin-tab-content.active {
            display: block;
        }

        /* Coming Soon placeholder */
        .odin-coming-soon {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 60vh;
            text-align: center;
            padding: 48px 24px;
        }

        .odin-coming-soon-icon {
            width: 80px;
            height: 80px;
            background: rgba(139, 92, 246, 0.1);
            border: 2px solid rgba(139, 92, 246, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 24px;
        }

        .odin-coming-soon-icon svg {
            width: 40px;
            height: 40px;
            color: var(--accent-purple);
        }

        .odin-coming-soon h2 {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text-primary);
        }

        .odin-coming-soon p {
            color: var(--text-secondary);
            font-size: 16px;
            max-width: 500px;
            line-height: 1.6;
        }
    </style>
</head>

<body class="has-tab-nav">
    <div class="background-globes"></div>

    <!-- Tab Navigation (shared component) -->
    <nav class="odin-tab-nav" id="odin-nav" data-active="designer" data-base="" aria-label="Main navigation"></nav>
    <script src="js/nav.js"></script>

    <!-- Designer Tab Content -->
    <div id="tab-designer" class="odin-tab-content active">
    <main class="container">
        <!-- Breadcrumb Navigation -->
        <nav id="breadcrumb-nav" class="breadcrumb-nav hidden" aria-label="Wizard steps navigation">
            <div class="breadcrumb-container">
                <button type="button" class="breadcrumb-item" data-step="step-1" onclick="navigateToStep('step-1')" title="Deployment Type" aria-label="Step 1: Deployment Type">
                    <span class="breadcrumb-number">1</span>
                    <span class="breadcrumb-label">Type</span>
                    <span class="breadcrumb-check" aria-hidden="true">‚úì</span>
                </button>
                <span class="breadcrumb-separator">‚Ä∫</span>
                <button type="button" class="breadcrumb-item" data-step="step-cloud" onclick="navigateToStep('step-cloud')" title="Azure Cloud" aria-label="Step 2: Azure Cloud">
                    <span class="breadcrumb-number">2</span>
                    <span class="breadcrumb-label">Cloud</span>
                    <span class="breadcrumb-check" aria-hidden="true">‚úì</span>
                </button>
                <span class="breadcrumb-separator">‚Ä∫</span>
                <button type="button" class="breadcrumb-item" data-step="step-local-region" onclick="navigateToStep('step-local-region')" title="Azure Region" aria-label="Step 3: Azure Region">
                    <span class="breadcrumb-number">3</span>
                    <span class="breadcrumb-label">Region</span>
                    <span class="breadcrumb-check" aria-hidden="true">‚úì</span>
                </button>
                <span class="breadcrumb-separator">‚Ä∫</span>
                <button type="button" class="breadcrumb-item" data-step="step-2" onclick="navigateToStep('step-2')" title="Scale" aria-label="Step 4: Scale">
                    <span class="breadcrumb-number">4</span>
                    <span class="breadcrumb-label">Scale</span>
                    <span class="breadcrumb-check" aria-hidden="true">‚úì</span>
                </button>
                <span class="breadcrumb-separator">‚Ä∫</span>
                <button type="button" class="breadcrumb-item" data-step="step-3" onclick="navigateToStep('step-3')" title="Nodes" aria-label="Step 5: Nodes">
                    <span class="breadcrumb-number">5</span>
                    <span class="breadcrumb-label">Nodes</span>
                    <span class="breadcrumb-check" aria-hidden="true">‚úì</span>
                </button>
                <span class="breadcrumb-separator">‚Ä∫</span>
                <button type="button" class="breadcrumb-item" data-step="step-11" onclick="navigateToStep('step-11')" title="Infrastructure" aria-label="Step 6: Infrastructure">
                    <span class="breadcrumb-number">6</span>
                    <span class="breadcrumb-label">Infra</span>
                    <span class="breadcrumb-check" aria-hidden="true">‚úì</span>
                </button>
                <span class="breadcrumb-separator">‚Ä∫</span>
                <button type="button" class="breadcrumb-item" data-step="step-13" onclick="navigateToStep('step-13')" title="Identity" aria-label="Step 7: Identity">
                    <span class="breadcrumb-number">7</span>
                    <span class="breadcrumb-label">Identity</span>
                    <span class="breadcrumb-check" aria-hidden="true">‚úì</span>
                </button>
                <span class="breadcrumb-separator">‚Ä∫</span>
                <button type="button" class="breadcrumb-item" data-step="step-14" onclick="navigateToStep('step-14')" title="Security & SDN" aria-label="Step 8: Security & SDN">
                    <span class="breadcrumb-number">8</span>
                    <span class="breadcrumb-label">Security</span>
                    <span class="breadcrumb-check" aria-hidden="true">‚úì</span>
                </button>
            </div>
        </nav>

        <div class="disclaimer-wrapper">
            <div class="disclaimer-banner">
                <strong>‚ö†Ô∏è Disclaimer:</strong> This tool is provided as-is, without Microsoft support. Odin is an experimental project that accelerates skills and knowledge ramp up for Azure Local, and helps IT architects validate cluster design configurations.
            </div>
        </div>

        <header>
            <div class="header-title-wrapper">
                <h1 class="header-title">Odin for Azure Local</h1>
                <div class="header-logo-wrapper">
                    <img id="odin-logo" src="images/odin-logo.png" alt="Odin for Azure Local Logo">
                    <div class="header-version">
                        Version 0.14.54 | <a href="#" onclick="event.preventDefault(); showChangelog();" class="whats-new-link">What's New</a>
                    </div>
                </div>
            </div>
            <p class="header-description">Odin, the Norse god embodying strategic thinking and architecture, is your guide for Azure Local deployments. This <strong>O</strong>ptimal <strong>D</strong>eployment and <strong>I</strong>nfrastructure <strong>N</strong>avigator provides a decision tree interface to select an Azure Local deployment type, and instance design using validated architecture and network configuration.</p>

            <!-- Page Statistics -->
            <div id="page-statistics">
                <div class="stats-container">
                    <div class="stat-item">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--accent-blue)" stroke-width="2">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                            <circle cx="12" cy="12" r="3"/>
                        </svg>
                        <span class="stat-label">Page Views:</span>
                        <span id="stat-page-views" class="stat-value">‚Äî</span>
                    </div>
                    <div class="stat-item">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--accent-blue)" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                            <polyline points="14 2 14 8 20 8"/>
                        </svg>
                        <span class="stat-label">Designs Generated:</span>
                        <span id="stat-design-docs" class="stat-value">‚Äî</span>
                    </div>
                    <div class="stat-item">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--accent-blue)" stroke-width="2">
                            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                        </svg>
                        <span class="stat-label">ARM Deployments:</span>
                        <span id="stat-arm-deployments" class="stat-value">‚Äî</span>
                    </div>
                </div>
            </div>
        </header>

        <noscript>
            <div class="info-box warning visible" style="margin-top: 1rem;">
                <strong>JavaScript is required</strong>
                <p>This wizard needs JavaScript enabled to work. If you're viewing this inside a restricted preview, open the page in a full browser.</p>
            </div>
        </noscript>

        <div class="layout-flex">
            <div class="steps-column">
                <!-- Step 1: Scenario -->
                <!-- Step 1: Scenario / Architecture -->
                <section class="step" id="step-1">
                    <div class="step-header">
                        <span class="step-number">01</span>
                        <h2>Deployment Type</h2>
                    </div>
                    <p style="margin: 0 0 16px 0; color: var(--text-secondary); font-size: 14px;">
                        <a href="https://learn.microsoft.com/azure/azure-local/scalability-deployments" target="_blank" rel="noopener noreferrer" style="color: var(--accent-blue); text-decoration: none; font-weight: 500;">
                            üìò Help and information for Deployment Types
                        </a>
                    </p>
                    <div class="options-grid">
                        <!-- Option 1: Hyperconverged -->
                        <div class="option-card" data-value="hyperconverged"
                            onclick="selectOption('scenario', 'hyperconverged')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <rect x="2" y="4" width="20" height="16" rx="2" stroke-width="1.5" />
                                    <line x1="2" y1="12" x2="22" y2="12" stroke-width="1.5" />
                                    <!-- Database icon overlay -->
                                    <ellipse cx="17" cy="7" rx="4" ry="2" stroke-width="1.2" fill="rgba(59, 130, 246, 0.1)" />
                                    <path d="M13 7v3c0 1.1 1.79 2 4 2s4-.9 4-2V7" stroke-width="1.2" />
                                    <path d="M13 10v3c0 1.1 1.79 2 4 2s4-.9 4-2v-3" stroke-width="1.2" />
                                </svg>
                            </div>
                            <h3>Hyperconverged</h3>
                            <p>Single rack, or rack-aware cluster providing hyperconverged compute, storage and network.</p>
                        </div>

                        <!-- Option 2: Multi-Rack -->
                        <div class="option-card" data-value="multirack" onclick="selectOption('scenario', 'multirack')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M4 2h5v20H4zM15 2h5v20h-5z" stroke-width="1.5" />
                                    <path d="M9 12h6" stroke-width="1.5" stroke-dasharray="2 2" />
                                </svg>
                            </div>
                            <h3>Multi-Rack</h3>
                            <p>Scalable, multi-rack distributed architecture.</p>
                        </div>

                        <!-- Option 3: Disconnected -->
                        <div class="option-card" data-value="disconnected"
                            onclick="selectOption('scenario', 'disconnected')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" stroke-width="1.5"
                                        fill="rgba(255, 255, 255, 0.05)" />
                                </svg>
                            </div>
                            <h3>Disconnected</h3>
                            <p>Air-gapped operation with local management.</p>
                        </div>

                        <!-- Option 4: M365 Local -->
                        <div class="option-card" data-value="m365local"
                            onclick="selectOption('scenario', 'm365local')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <rect x="3" y="3" width="18" height="18" rx="2" stroke-width="1.5" />
                                    <path d="M3 9h18M9 3v18" stroke-width="1.5" />
                                    <circle cx="15" cy="15" r="3" stroke-width="1.5" fill="rgba(59, 130, 246, 0.1)" />
                                </svg>
                            </div>
                            <h3>M365 Local</h3>
                            <p>Microsoft 365 workloads with minimum 9 nodes.</p>
                        </div>
                    </div>

                    <div id="scenario-explanation" class="info-box"></div>

                    <div id="multirack-message" class="info-box warning hidden">
                        <strong style="color: var(--accent-purple); font-size: 1.1rem;">Contact Microsoft</strong>
                        <p>For Multi-Rack Network Architecture requirements, please contact your Microsoft
                            representative to
                            understand the network requirements.<br>
                            <a href="https://learn.microsoft.com/en-us/azure/azure-local/multi-rack/multi-rack-overview?view=azloc-2511"
                                target="_blank" style="color: var(--accent-blue); text-decoration: underline;">Read the
                                documentation</a>
                        </p>
                    </div>
                    <div id="m365local-message" class="info-box warning hidden">
                        <strong style="color: var(--accent-purple); font-size: 1.1rem;">Review Documentation</strong>
                        <p>For information on M365 Local on Azure Local review documentation.<br>
                            <a href="https://learn.microsoft.com/azure/azure-local/concepts/microsoft-365-local-overview"
                                target="_blank" style="color: var(--accent-blue); text-decoration: underline;">Read the
                                documentation</a>
                        </p>
                    </div>
                </section>
                <section class="step" id="step-cloud">
                    <div class="step-header">
                        <span class="step-number">02</span>
                        <h2>Azure Cloud</h2>
                    </div>
                    <p style="margin: 0 0 16px 0; color: var(--text-secondary); font-size: 14px;">
                        <a href="https://learn.microsoft.com/azure/azure-local/concepts/system-requirements-23h2?tabs=azure-public#azure-requirements" target="_blank" rel="noopener noreferrer" style="color: var(--accent-blue); text-decoration: none; font-weight: 500;">
                            üìò Information for supported Azure regions
                        </a>
                    </p>
                    <div class="options-grid">
                        <div class="option-card" data-value="azure_commercial"
                            onclick="selectOption('region', 'azure_commercial')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"></path>
                                </svg>
                            </div>
                            <h3>Azure Commercial</h3>
                            <p>Global Azure regions.</p>
                        </div>
                        <div class="option-card" data-value="azure_government"
                            onclick="selectOption('region', 'azure_government')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2z">
                                    </path>
                                    <path d="M12 2v20"></path>
                                    <path d="M2 12h20"></path>
                                </svg>
                            </div>
                            <h3>Azure Government</h3>
                            <p>US Government regions.</p>
                        </div>
                        <div class="option-card" data-value="azure_china"
                            onclick="selectOption('region', 'azure_china')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <path
                                        d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z">
                                    </path>
                                    <path d="M2 12h20"></path>
                                </svg>
                            </div>
                            <h3>Azure China</h3>
                            <p>China regions.</p>
                        </div>
                    </div>
                    <div id="china-warning" class="info-box warning hidden" style="margin-top:1rem;">
                        <strong style="color:var(--accent-purple)">Unsupported Region</strong>
                        <p>Azure Local is not supported in Azure China region.</p>
                    </div>
                </section>

                <!-- Step 3: Azure Local Instance Region -->
                <section class="step" id="step-local-region">
                    <div class="step-header">
                        <span class="step-number">03</span>
                        <h2>Azure region for Azure Local resources</h2>
                    </div>

                    <div class="options-grid compact">
                        <!-- Azure public cloud supported regions (alphabetical order) -->
                        <div class="option-card" data-value="australia_east" data-cloud="azure_commercial"
                            onclick="selectOption('localInstanceRegion', 'australia_east')">
                            <h3>Australia East</h3>
                            <p>Azure public</p>
                        </div>
                        <div class="option-card" data-value="canada_central" data-cloud="azure_commercial"
                            onclick="selectOption('localInstanceRegion', 'canada_central')">
                            <h3>Canada Central</h3>
                            <p>Azure public</p>
                        </div>
                        <div class="option-card" data-value="east_us" data-cloud="azure_commercial"
                            onclick="selectOption('localInstanceRegion', 'east_us')">
                            <h3>East US</h3>
                            <p>Azure public</p>
                        </div>
                        <div class="option-card" data-value="india_central" data-cloud="azure_commercial"
                            onclick="selectOption('localInstanceRegion', 'india_central')">
                            <h3>India Central</h3>
                            <p>Azure public</p>
                        </div>
                        <div class="option-card" data-value="japan_east" data-cloud="azure_commercial"
                            onclick="selectOption('localInstanceRegion', 'japan_east')">
                            <h3>Japan East</h3>
                            <p>Azure public</p>
                        </div>
                        <div class="option-card" data-value="south_central_us" data-cloud="azure_commercial"
                            onclick="selectOption('localInstanceRegion', 'south_central_us')">
                            <h3>South Central US</h3>
                            <p>Azure public</p>
                        </div>
                        <div class="option-card" data-value="southeast_asia" data-cloud="azure_commercial"
                            onclick="selectOption('localInstanceRegion', 'southeast_asia')">
                            <h3>Southeast Asia</h3>
                            <p>Azure public</p>
                        </div>
                        <div class="option-card" data-value="west_europe" data-cloud="azure_commercial"
                            onclick="selectOption('localInstanceRegion', 'west_europe')">
                            <h3>West Europe</h3>
                            <p>Azure public</p>
                        </div>

                        <!-- Azure Government supported region -->
                        <div class="option-card" data-value="us_gov_virginia" data-cloud="azure_government"
                            onclick="selectOption('localInstanceRegion', 'us_gov_virginia')">
                            <h3>US Gov Virginia</h3>
                            <p>Azure Government</p>
                        </div>
                    </div>
                    <div id="disconnected-region-info" class="info-box hidden" style="margin-top:1rem;">
                        <strong style="color:var(--accent-blue)">‚ÑπÔ∏è Azure Region for Disconnected</strong>
                        <p>Required to download the control plane appliance image, updates and licensing.</p>
                    </div>
                </section>

                <!-- Step 2: Scale (Conditional) -->
                <section class="step" id="step-2">
                    <div class="step-header">
                        <span class="step-number">04</span>
                        <h2>Cluster Configuration</h2>
                    </div>

                    <!-- Scale Options -->
                    <div class="options-grid" id="scale-options">
                        <div class="option-card" data-value="low_capacity"
                            onclick="selectOption('scale', 'low_capacity')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M4 4h16v16H4z" stroke-width="1.5" opacity="0.1" fill="currentColor" />
                                    <rect x="4" y="4" width="16" height="16" rx="2" stroke-width="1.5" />
                                    <circle cx="12" cy="12" r="3" stroke-width="1.5" />
                                </svg>
                            </div>
                            <h3>Hyperconverged Low Capacity</h3>
                            <p>Edge / Small Scale usage (Max 3 nodes).</p>
                            <a href="https://learn.microsoft.com/azure/azure-local/concepts/system-requirements-small-23h2" target="_blank" class="info-link" onclick="event.stopPropagation();">Learn more ‚Üó</a>
                        </div>

                        <div class="option-card" data-value="medium" onclick="selectOption('scale', 'medium')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <rect x="2" y="4" width="9" height="7" rx="1" stroke-width="1.5" />
                                    <rect x="13" y="4" width="9" height="7" rx="1" stroke-width="1.5" />
                                    <rect x="2" y="13" width="9" height="7" rx="1" stroke-width="1.5" />
                                    <rect x="13" y="13" width="9" height="7" rx="1" stroke-width="1.5" />
                                </svg>
                            </div>
                            <h3>Hyperconverged</h3>
                            <p>1 to 16 nodes.</p>
                        </div>
                        <div class="option-card" data-value="rack_aware" onclick="selectOption('scale', 'rack_aware')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <rect x="3" y="3" width="7" height="18" rx="1" stroke-width="1.5" />
                                    <rect x="14" y="3" width="7" height="18" rx="1" stroke-width="1.5" />
                                    <path d="M7 7h0M7 11h0M7 15h0M7 19h0" stroke-width="2" stroke-linecap="round" />
                                    <path d="M18 7h0M18 11h0M18 15h0M18 19h0" stroke-width="2" stroke-linecap="round" />
                                </svg>
                            </div>
                            <h3>Hyperconverged Rack Aware</h3>
                            <p>Spread across rooms (2, 4, 6, 8 nodes).</p>
                            <a href="https://learn.microsoft.com/azure/azure-local/concepts/rack-aware-cluster-overview" target="_blank" class="info-link" onclick="event.stopPropagation();">Learn more ‚Üó</a>
                        </div>
                    </div>
                </section>

                <!-- Step 3: Cluster Size -->
                <section class="step" id="step-3">
                    <div class="step-header">
                        <span class="step-number">05</span>
                        <h2>Cluster Size</h2>
                    </div>
                    <!-- Updated Node Selection Grid -->
                    <div class="nodes-grid">
                        <!-- Generated by Script or Static? Static for clarity -->
                        <div class="node-chip" onclick="selectOption('nodes', '1')">1</div>
                        <div class="node-chip" onclick="selectOption('nodes', '2')">2</div>
                        <div class="node-chip" onclick="selectOption('nodes', '3')">3</div>
                        <div class="node-chip" onclick="selectOption('nodes', '4')">4</div>
                        <div class="node-chip" onclick="selectOption('nodes', '5')">5</div>
                        <div class="node-chip" onclick="selectOption('nodes', '6')">6</div>
                        <div class="node-chip" onclick="selectOption('nodes', '7')">7</div>
                        <div class="node-chip" onclick="selectOption('nodes', '8')">8</div>
                        <div class="node-chip" onclick="selectOption('nodes', '9')">9</div>
                        <div class="node-chip" onclick="selectOption('nodes', '10')">10</div>
                        <div class="node-chip" onclick="selectOption('nodes', '11')">11</div>
                        <div class="node-chip" onclick="selectOption('nodes', '12')">12</div>
                        <div class="node-chip" onclick="selectOption('nodes', '13')">13</div>
                        <div class="node-chip" onclick="selectOption('nodes', '14')">14</div>
                        <div class="node-chip" onclick="selectOption('nodes', '15')">15</div>
                        <div class="node-chip" onclick="selectOption('nodes', '16')">16</div>
                        <div class="node-chip" onclick="selectOption('nodes', '16+')" style="font-weight: 700;">16+
                        </div>

                        <div id="nodes-context" class="node-context">
                            <!-- Dynamic text will verify size implications -->
                            Selected: <span id="nodes-count-display">-</span> Nodes. <span
                                id="nodes-implication"></span>
                        </div>
                    </div>

                    <!-- Conditional: Rack Aware only (after selecting nodes) -->
                    <div id="rack-aware-zones" class="hidden" style="margin-top: 1.5rem;">
                        <div style="margin-bottom: 0.9rem;">
                            <div style="font-weight: 700; letter-spacing: -0.01em;">Local availability zones</div>
                            <div style="color: var(--text-secondary); font-size: 0.95rem;">Define zone names and assign nodes to zones.</div>
                        </div>

                        <div class="rack-az-grid">
                            <div class="rack-az-card">
                                <div class="rack-az-card__title">Local availability zone 1</div>
                                <div class="rack-az-field">
                                    <label class="rack-az-label" for="rack-az1-name">Local availability zone name 1 <span style="color: var(--accent-purple);">*</span></label>
                                    <input id="rack-az1-name" class="rack-az-input" type="text" value="Zone1" oninput="updateRackAwareZoneName(1, this.value)">
                                </div>
                                <div class="rack-az-field">
                                    <div class="rack-az-label">Servers on local availability zone 1 <span style="color: var(--accent-purple);">*</span></div>
                                    <div id="rack-az1-drop" class="rack-az-drop" role="group" aria-label="Zone 1 node assignment drop area"></div>
                                </div>
                                <div class="info-box visible" style="margin-top: 0.75rem;">
                                    <strong>Note</strong>
                                    You need to assign your servers equally across 2 Local availability zones. Nodes not placed in Zone 1 will automatically be assigned to Zone 2.
                                </div>
                            </div>

                            <div class="rack-az-card">
                                <div class="rack-az-card__title">Local availability zone 2</div>
                                <div class="rack-az-field">
                                    <label class="rack-az-label" for="rack-az2-name">Local availability zone name 2 <span style="color: var(--accent-purple);">*</span></label>
                                    <input id="rack-az2-name" class="rack-az-input" type="text" value="Zone2" oninput="updateRackAwareZoneName(2, this.value)">
                                </div>
                                <div class="rack-az-field">
                                    <div class="rack-az-label">Servers on local availability zone 2</div>
                                    <div id="rack-az2-drop" class="rack-az-drop" role="group" aria-label="Zone 2 node assignment drop area"></div>
                                </div>
                            </div>
                        </div>

                        <div class="info-box visible" style="margin-top: 0.9rem;">
                            <strong>Tip</strong>
                            If drag-and-drop is restricted in your browser, click a node to select it, then click a node in the other zone to swap them.
                        </div>

                        <div style="margin-top: 0.9rem; display: flex; gap: 0.75rem; align-items: center; flex-wrap: wrap;">
                            <button id="rack-aware-zones-confirm-btn" type="button" class="report-action-button rack-aware-zones-confirm-btn" style="flex: 0 0 auto; min-width: 260px;">Confirm zones &amp; node placement</button>
                            <div id="rack-aware-zones-confirm-status" style="color: var(--text-secondary); font-size: 0.95rem;"></div>
                        </div>
                    </div>

                    <!-- Conditional: Rack Aware ToR switch architecture (after selecting nodes) -->
                    <div id="rack-aware-tor" class="hidden" style="margin-top: 1.5rem;">
                        <div style="margin-bottom: 0.9rem;">
                            <div style="font-weight: 700; letter-spacing: -0.01em;">TOR switch architecture</div>
                            <div style="color: var(--text-secondary); font-size: 0.95rem;">Select your top-of-rack (TOR) switch layout for a Rack Aware (multi-room) cluster.</div>
                        </div>

                        <div style="margin-bottom: 0.75rem; font-weight: 600;">How many TOR switches per room? <span style="color: var(--accent-purple);">*</span></div>
                        <div class="options-grid">
                            <div class="option-card" data-value="1" onclick="selectOption('rackAwareTorsPerRoom', '1')">
                                <div class="icon">
                                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                        <rect x="5" y="7" width="14" height="10" rx="2" fill="rgba(255,255,255,0.06)" />
                                        <circle cx="9" cy="12" r="1.2" fill="currentColor" />
                                        <circle cx="13" cy="12" r="1.2" fill="currentColor" />
                                        <circle cx="17" cy="12" r="1.2" fill="currentColor" />
                                    </svg>
                                </div>
                                <h3>1 TOR per room</h3>
                            </div>
                            <div class="option-card" data-value="2" onclick="selectOption('rackAwareTorsPerRoom', '2')">
                                <div class="icon">
                                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                        <rect x="3" y="7" width="8" height="10" rx="2" fill="rgba(255,255,255,0.06)" />
                                        <rect x="13" y="7" width="8" height="10" rx="2" fill="rgba(255,255,255,0.06)" />
                                        <path d="M11 12H13" stroke-dasharray="2 2" />
                                    </svg>
                                </div>
                                <h3>2 TORs per room</h3>
                            </div>
                        </div>

                        <div id="rack-aware-tor-options-2" class="hidden" style="margin-top: 1rem;">
                            <div style="margin-bottom: 0.75rem; font-weight: 600;">Select the architecture option <span style="color: var(--accent-purple);">*</span></div>
                            <div class="options-grid">
                                <div class="option-card" data-value="option_a" onclick="selectOption('rackAwareTorArchitecture', 'option_a')">
                                    <div class="icon">
                                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                            <path d="M4 8h16" />
                                            <path d="M4 16h16" />
                                            <path d="M8 8v8" stroke-dasharray="2 2" />
                                            <path d="M16 8v8" stroke-dasharray="2 2" />
                                        </svg>
                                    </div>
                                    <h3>Dedicated storage links</h3>
                                    <p>4 TORs total. VLAN 711 and VLAN 712 use separate, dedicated room-to-room link sets (storage bypasses MLAG to reduce RDMA hops).</p>
                                </div>
                                <div class="option-card" data-value="option_b" onclick="selectOption('rackAwareTorArchitecture', 'option_b')">
                                    <div class="icon">
                                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                            <path d="M5 9h14" />
                                            <path d="M5 15h14" />
                                            <path d="M7 9l10 6" stroke-dasharray="3 3" />
                                            <path d="M7 15l10-6" stroke-dasharray="3 3" />
                                        </svg>
                                    </div>
                                    <h3>Aggregated storage links</h3>
                                    <p>4 TORs total. Storage uses port-channels/vPC across rooms; traffic path depends on hashing and can traverse MLAG (potential latency increase).</p>
                                </div>
                            </div>
                        </div>

                        <div id="rack-aware-tor-options-1" class="hidden" style="margin-top: 1rem;">
                            <div style="margin-bottom: 0.75rem; font-weight: 600;">Select the architecture option <span style="color: var(--accent-purple);">*</span></div>
                            <div class="options-grid">
                                <div class="option-card" data-value="option_c" onclick="selectOption('rackAwareTorArchitecture', 'option_c')">
                                    <div class="icon">
                                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                            <rect x="5" y="7" width="14" height="10" rx="2" fill="rgba(255,255,255,0.06)" />
                                            <path d="M7 12h10" stroke-dasharray="2 2" />
                                        </svg>
                                    </div>
                                    <h3>Per-room node connectivity</h3>
                                    <p>2 TORs total. SMB1 and SMB2 are hosted on the same TOR in each zone; simpler wiring but no TOR redundancy within a zone (single point of failure per zone).</p>
                                </div>
                                <div class="option-card" data-value="option_d" onclick="selectOption('rackAwareTorArchitecture', 'option_d')">
                                    <div class="icon">
                                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                            <path d="M6 8h12" />
                                            <path d="M6 16h12" />
                                            <path d="M6 8l12 8" stroke-dasharray="2 2" />
                                        </svg>
                                    </div>
                                    <h3>Cross-room node connectivity</h3>
                                    <p>2 TORs total. Each node connects to TORs in both rooms; reduces dependence on TOR-to-TOR RDMA room links but requires cross-room fiber per node interface.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Step 3.5: Cloud Witness Type -->
                <section class="step" id="step-3-5">
                    <div class="step-header">
                        <span class="step-number">05.5</span>
                        <h2>Cloud Witness Type</h2>
                        <a href="https://learn.microsoft.com/windows-server/failover-clustering/deploy-quorum-witness" target="_blank" class="step-info-link" title="Learn about Cloud Witness">‚ÑπÔ∏è</a>
                    </div>
                    <div id="witness-info" class="info-box visible" style="margin-bottom:1.5rem;">
                        The witness type is automatically determined based on your cluster configuration.
                    </div>
                    <div class="options-grid">
                        <div class="option-card" data-value="Cloud"
                            onclick="selectOption('witnessType', 'Cloud')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z" stroke-width="1.5" fill="rgba(0, 120, 212, 0.1)" />
                                </svg>
                            </div>
                            <h3>Cloud</h3>
                            <p>Azure cloud witness for high availability</p>
                        </div>
                        <div class="option-card" data-value="NoWitness"
                            onclick="selectOption('witnessType', 'NoWitness')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <circle cx="12" cy="12" r="10" stroke-width="1.5" fill="rgba(255, 255, 255, 0.05)" />
                                    <path d="M15 9l-6 6M9 9l6 6" stroke-width="2" stroke-linecap="round" />
                                </svg>
                            </div>
                            <h3>No Witness</h3>
                            <p>No witness configuration</p>
                        </div>
                    </div>
                </section>

                <!-- Step 4: Storage Connectivity -->
                <section class="step" id="step-4">
                    <div class="step-header">
                        <span class="step-number">06</span>
                        <h2 id="step-4-title">Storage Connectivity</h2>
                        <button id="storage-compare-btn" type="button" onclick="event.stopPropagation(); showComparison('storage');" style="margin-left: auto; padding: 6px 12px; background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); color: var(--accent-blue); border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                            Compare Options
                        </button>
                    </div>
                    <div id="storage-options-grid" class="options-grid">
                        <div class="option-card" data-value="switched" onclick="selectOption('storage', 'switched')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <rect x="2" y="6" width="20" height="12" rx="2" fill="rgba(0, 120, 212, 0.2)" />
                                    <circle cx="6" cy="12" r="1.5" fill="currentColor" />
                                    <circle cx="10" cy="12" r="1.5" fill="currentColor" />
                                    <circle cx="14" cy="12" r="1.5" fill="currentColor" />
                                    <circle cx="18" cy="12" r="1.5" fill="currentColor" />
                                </svg>
                            </div>
                            <h3>Storage Switched</h3>
                            <p>Physical ToR switch. Required for 5+ nodes.</p>
                        </div>
                        <div class="option-card" data-value="switchless"
                            onclick="selectOption('storage', 'switchless')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="1.5">
                                    <rect x="2" y="4" width="6" height="16" rx="1" fill="rgba(255, 255, 255, 0.1)" />
                                    <rect x="16" y="4" width="6" height="16" rx="1" fill="rgba(255, 255, 255, 0.1)" />
                                    <path d="M8 8H16" stroke-dasharray="2 2" />
                                    <path d="M8 12H16" stroke-dasharray="2 2" />
                                    <path d="M8 16H16" stroke-dasharray="2 2" />
                                </svg>
                            </div>
                            <h3>Storage Switchless</h3>
                            <p>Direct connection. Only for 1-4 nodes.</p>
                        </div>
                    </div>

                    <!-- Conditional: Storage Switched + Hyperconverged/Low Capacity -->
                    <div id="tor-switch-count" class="hidden" style="margin-top: 1.5rem;">
                        <div style="margin-bottom: 0.9rem;">
                            <div style="font-weight: 700; letter-spacing: -0.01em;">ToR Switch Configuration</div>
                            <div id="tor-switch-description" style="color: var(--text-secondary); font-size: 0.95rem;">Select the number of Top-of-Rack switches for storage connectivity.</div>
                        </div>
                        <div class="options-grid">
                            <div id="tor-single-option" class="option-card" data-value="single"
                                onclick="selectOption('torSwitchCount', 'single')">
                                <div class="icon">
                                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                        <rect x="4" y="4" width="16" height="6" rx="2" fill="rgba(0, 120, 212, 0.2)" />
                                        <circle cx="8" cy="7" r="1" fill="currentColor" />
                                        <circle cx="12" cy="7" r="1" fill="currentColor" />
                                        <circle cx="16" cy="7" r="1" fill="currentColor" />
                                        <path d="M12 10V14" stroke-dasharray="2 2" />
                                        <rect x="8" y="14" width="8" height="6" rx="1" fill="rgba(255, 255, 255, 0.1)" />
                                    </svg>
                                </div>
                                <h3>Single ToR Switch</h3>
                                <p>One ToR switch (no redundancy at switch level).</p>
                            </div>
                            <div id="tor-dual-option" class="option-card" data-value="dual"
                                onclick="selectOption('torSwitchCount', 'dual')">
                                <div class="badge-recommended">Recommended</div>
                                <div class="icon">
                                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                        <rect x="2" y="4" width="8" height="5" rx="1.5" fill="rgba(0, 120, 212, 0.2)" />
                                        <rect x="14" y="4" width="8" height="5" rx="1.5" fill="rgba(0, 120, 212, 0.2)" />
                                        <circle cx="5" cy="6.5" r="0.8" fill="currentColor" />
                                        <circle cx="8" cy="6.5" r="0.8" fill="currentColor" />
                                        <circle cx="17" cy="6.5" r="0.8" fill="currentColor" />
                                        <circle cx="20" cy="6.5" r="0.8" fill="currentColor" />
                                        <path d="M6 9V14" stroke-dasharray="2 2" />
                                        <path d="M18 9V14" stroke-dasharray="2 2" />
                                        <rect x="8" y="14" width="8" height="6" rx="1" fill="rgba(255, 255, 255, 0.1)" />
                                    </svg>
                                </div>
                                <h3>Dual ToR Switches</h3>
                                <p>Two ToR switches (recommended for redundancy).</p>
                            </div>
                        </div>
                        <div id="tor-single-disabled-info" class="info-box hidden" style="margin-top: 0.75rem;">
                            <strong>‚ÑπÔ∏è Single ToR Switch Unavailable</strong>
                            Single ToR Switch is not supported for Hyperconverged clusters with 4 or more nodes. Dual ToR switches are required to provide the necessary redundancy and bandwidth for larger cluster deployments.
                        </div>
                    </div>

                    <!-- Conditional: 3-node + Low Capacity + Switchless only -->
                    <div id="switchless-link-mode" class="hidden" style="margin-top: 1.5rem;">
                        <div style="margin-bottom: 0.9rem;">
                            <div style="font-weight: 700; letter-spacing: -0.01em;">Switchless Link Configuration</div>
                            <div style="color: var(--text-secondary); font-size: 0.95rem;">Select the storage fabric wiring pattern for this specific topology.</div>
                        </div>
                        <div class="options-grid">
                            <div class="option-card" data-value="single_link"
                                onclick="selectOption('switchlessLinkMode', 'single_link')">
                                <div class="icon">
                                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                        <circle cx="6" cy="12" r="2" fill="rgba(255, 255, 255, 0.06)" />
                                        <circle cx="18" cy="12" r="2" fill="rgba(255, 255, 255, 0.06)" />
                                        <path d="M8 12H16" stroke-dasharray="3 3" />
                                    </svg>
                                </div>
                                <h3>Single-Link configuration</h3>
                                <p>One storage link per node-pair (no redundancy).</p>
                            </div>
                            <div class="option-card" data-value="dual_link"
                                onclick="selectOption('switchlessLinkMode', 'dual_link')">
                                <div class="icon">
                                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                        <circle cx="6" cy="9" r="2" fill="rgba(255, 255, 255, 0.06)" />
                                        <circle cx="18" cy="9" r="2" fill="rgba(255, 255, 255, 0.06)" />
                                        <circle cx="6" cy="15" r="2" fill="rgba(255, 255, 255, 0.06)" />
                                        <circle cx="18" cy="15" r="2" fill="rgba(255, 255, 255, 0.06)" />
                                        <path d="M8 9H16" />
                                        <path d="M8 15H16" />
                                    </svg>
                                </div>
                                <h3>Dual-Link configuration</h3>
                                <p>Two storage links per node-pair (redundant).</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Step 5: Network Adapter Ports -->
                <section class="step" id="step-5">
                    <div class="step-header">
                        <span class="step-number">07</span>
                        <h2>Network Adapter Ports</h2>
                    </div>
                    <div class="options-grid">
                        <div id="port-option-1" class="option-card hidden" data-value="1"
                            onclick="selectOption('ports', '1')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <rect x="2" y="8" width="20" height="8" rx="2" fill="rgba(255, 255, 255, 0.05)" />
                                    <circle cx="12" cy="12" r="1.5" fill="currentColor" />
                                </svg>
                            </div>
                            <h3>1 Port</h3>
                            <p>Single Node Only.</p>
                        </div>
                        <div class="option-card" data-value="2" onclick="selectOption('ports', '2')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <rect x="2" y="8" width="20" height="8" rx="2" fill="rgba(255, 255, 255, 0.05)" />
                                    <circle cx="6" cy="12" r="1.5" fill="currentColor" />
                                    <circle cx="10" cy="12" r="1.5" fill="currentColor" />
                                </svg>
                            </div>
                            <h3>2 Ports</h3>
                            <p>Minimum. Converged only.</p>
                        </div>
                        <div class="option-card" data-value="4" onclick="selectOption('ports', '4')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <rect x="2" y="8" width="20" height="8" rx="2" fill="rgba(255, 255, 255, 0.05)" />
                                    <circle cx="5" cy="12" r="1.5" fill="currentColor" />
                                    <circle cx="9" cy="12" r="1.5" fill="currentColor" />
                                    <circle cx="15" cy="12" r="1.5" fill="currentColor" />
                                    <circle cx="19" cy="12" r="1.5" fill="currentColor" />
                                </svg>
                            </div>
                            <h3>4 Ports</h3>
                            <p>Standard redundancy.</p>
                        </div>
                        <div class="option-card" data-value="6" onclick="selectOption('ports', '6')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <rect x="2" y="5" width="20" height="14" rx="2" fill="rgba(255, 255, 255, 0.05)" />
                                    <circle cx="6" cy="9" r="1" fill="currentColor" />
                                    <circle cx="10" cy="9" r="1" fill="currentColor" />
                                    <circle cx="14" cy="9" r="1" fill="currentColor" />
                                    <circle cx="6" cy="15" r="1" fill="currentColor" />
                                    <circle cx="10" cy="15" r="1" fill="currentColor" />
                                    <circle cx="14" cy="15" r="1" fill="currentColor" />
                                </svg>
                            </div>
                            <h3>6 Ports</h3>
                            <p>High flexibility.</p>
                        </div>
                        <div class="option-card" data-value="8" onclick="selectOption('ports', '8')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <rect x="2" y="5" width="20" height="14" rx="2" fill="rgba(255, 255, 255, 0.05)" />
                                    <circle cx="5" cy="9" r="1" fill="currentColor" />
                                    <circle cx="9" cy="9" r="1" fill="currentColor" />
                                    <circle cx="15" cy="9" r="1" fill="currentColor" />
                                    <circle cx="19" cy="9" r="1" fill="currentColor" />
                                    <circle cx="5" cy="15" r="1" fill="currentColor" />
                                    <circle cx="9" cy="15" r="1" fill="currentColor" />
                                    <circle cx="15" cy="15" r="1" fill="currentColor" />
                                    <circle cx="19" cy="15" r="1" fill="currentColor" />
                                </svg>
                            </div>
                            <h3>8 Ports</h3>
                            <p>Maximum resiliency and performance.</p>
                        </div>
                    </div>
                    <!-- Explanation Div -->
                    <div id="ports-explanation" class="info-box">
                        <strong style="color: var(--accent-purple);">Hardware Requirement</strong>
                        For multi-node clusters, at least two network ports must be RDMA-capable (iWARP/RoCEv2) to support high-performance Storage traffic.
                        <br><br>
                        For a 3-node Switchless deployment, you need at least 6 physical ports per node: two teamed ports for management/compute plus four standalone RDMA ports for storage.
                    </div>

                    <!-- NEW: Dynamic Port Configuration -->
                    <div id="port-configuration" class="port-config-section">
                        <h4>Port Configuration</h4>
                        <div id="rdma-validation-warning" class="info-box warning hidden" style="margin-top: 0.75rem;"></div>
                        <div id="port-config-grid" class="port-config-grid">
                            <!-- Dynamic Content -->
                        </div>
                        <div id="port-config-confirm-container" class="hidden" style="margin-top: 1.5rem; text-align: center;">
                            <button id="port-config-confirm-btn" class="confirm-port-config-btn" onclick="confirmPortConfiguration()">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="20 6 9 17 4 12"></polyline>
                                </svg>
                                Confirm Port Configuration
                            </button>
                            <p id="port-config-confirm-hint" style="margin-top: 0.5rem; font-size: 0.85rem; color: var(--text-secondary);">
                                Click to confirm your port configuration before proceeding.
                            </p>
                        </div>
                        <div id="port-config-confirmed-msg" class="hidden" style="margin-top: 1rem; text-align: center;">
                            <span style="color: var(--accent-green); font-weight: 600;">‚úì Port configuration confirmed</span>
                            <button style="margin-left: 1rem; background: transparent; border: 1px solid var(--text-secondary); color: var(--text-secondary); padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 0.85rem;" onclick="editPortConfiguration()">Edit</button>
                        </div>
                    </div>
                </section>


                <!-- Step 6: Network Traffic Intents -->
                <section class="step" id="step-6">
                    <div class="step-header">
                        <span class="step-number">08</span>
                        <h2>Network Traffic Intents</h2>
                        <a href="https://learn.microsoft.com/azure/azure-local/plan/cloud-deployment-network-considerations#step-3-determine-network-traffic-intents" target="_blank" class="step-info-link" title="Learn about Network Traffic Intents">‚ÑπÔ∏è</a>
                    </div>
                    <div class="options-grid">
                        <div class="option-card" data-value="all_traffic"
                            onclick="selectOption('intent', 'all_traffic')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <circle cx="12" cy="12" r="9" stroke-width="1.5" fill="rgba(0, 120, 212, 0.1)" />
                                    <path d="M12 7V17M7 12H17" stroke-width="2" />
                                </svg>
                            </div>
                            <h3>Group All Traffic</h3>
                            <p>Management + Compute + Storage.</p>
                        </div>
                        <div class="option-card" data-value="mgmt_compute"
                            onclick="selectOption('intent', 'mgmt_compute')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <rect x="3" y="3" width="8" height="18" rx="2" fill="rgba(0, 120, 212, 0.1)" />
                                    <rect x="13" y="3" width="8" height="18" rx="2" fill="rgba(255, 255, 255, 0.05)" />
                                </svg>
                            </div>
                            <h3>Management + Compute</h3>
                            <p>Storage separate.</p>
                        </div>
                        <div class="option-card" data-value="compute_storage"
                            onclick="selectOption('intent', 'compute_storage')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <rect x="3" y="3" width="8" height="18" rx="2" fill="rgba(255, 255, 255, 0.05)" />
                                    <rect x="13" y="3" width="8" height="18" rx="2" fill="rgba(139, 92, 246, 0.1)" />
                                </svg>
                            </div>
                            <h3>Compute + Storage</h3>
                            <p>Management separate.</p>
                        </div>
                        <div class="option-card" data-value="custom" onclick="selectOption('intent', 'custom')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M12 2L2 7L12 12L22 7L12 2Z" stroke-width="1.5" />
                                    <path d="M2 17L12 22L22 17" stroke-width="1.5" />
                                    <path d="M2 12L12 17L22 12" stroke-width="1.5" />
                                </svg>
                            </div>
                            <h3>Custom</h3>
                            <p>Full manual control.</p>
                        </div>

                        <div id="intent-explanation" class="info-box"></div>
                    </div>

                    <div id="rdma-intent-warning" class="info-box warning hidden" style="margin-top: 1rem;"></div>

                    <!-- Drag & Drop Adapter Mapping -->
                    <div id="nic-visualizer" class="nic-visualizer">
                        <div id="adapter-mapping-container" class="adapter-mapping hidden"><div class="adapter-mapping-header"><h4>Adapter Mapping Configuration</h4><p style="color:var(--text-secondary);font-size:0.9rem;">Drag and drop network adapters to assign them to traffic intents.</p></div><div class="adapter-pool"><div class="adapter-pool-header"><span class="adapter-pool-title">Available Network Adapters</span><span class="adapter-pool-hint">Drag adapters to intents below</span></div><div id="adapter-pool-drop" class="adapter-drop-zone pool-zone"></div></div><div id="intent-zones-grid" class="intent-zones-grid"></div><div class="info-box visible" style="margin-top:0.9rem;"><strong>Tip</strong> Click an adapter, then click a drop zone to move it.</div><div style="margin-top:0.9rem;display:flex;gap:0.75rem;flex-wrap:wrap;"><button id="adapter-mapping-confirm-btn" type="button" class="confirm-port-config-btn" onclick="confirmAdapterMapping()"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"></polyline></svg>Confirm Adapter Mapping</button><button id="adapter-mapping-reset-btn" type="button" class="report-action-button" onclick="resetAdapterMapping()" style="background:rgba(239,68,68,0.2);">Reset</button><div id="adapter-mapping-status" style="color:var(--text-secondary);"></div></div><div id="adapter-mapping-validation" class="info-box warning hidden" style="margin-top:0.9rem;"></div></div>

                        <div id="intent-overrides" class="intent-overrides hidden">
                            <h4>Overrides</h4>
                            <div id="intent-overrides-container" class="intent-overrides-grid"></div>
                            <div style="margin-top: 1rem; display: flex; gap: 0.75rem; flex-wrap: wrap; align-items: center;">
                                <button id="overrides-confirm-btn" type="button" class="confirm-port-config-btn" onclick="confirmOverrides()"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"></polyline></svg>Confirm Overrides</button>
                                <span id="overrides-status" style="color: var(--text-secondary); font-size: 0.9rem;"></span>
                            </div>
                        </div>
                    </div>

                    <div id="storage-auto-ip" style="margin-top:1.25rem;">
                        <h4>Storage Auto IP</h4>
                        <div class="options-grid">
                            <div class="option-card" data-value="enabled" onclick="selectOption('storageAutoIp', 'enabled')">
                                <div class="icon">
                                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <path d="M20 6L9 17l-5-5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                    </svg>
                                </div>
                                <h3>Storage Auto IP Enabled</h3>
                                <p>Automatically assign Storage IPs.</p>
                            </div>
                            <div class="option-card" data-value="disabled" onclick="selectOption('storageAutoIp', 'disabled')">
                                <div class="icon">
                                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <path d="M18 6L6 18" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                        <path d="M6 6l12 12" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                    </svg>
                                </div>
                                <h3>Storage Auto IP Disabled</h3>
                                <p>Manually specify Storage IPs.</p>
                            </div>
                        </div>
                        <!-- Custom Storage Subnets Input -->
                        <div id="custom-storage-subnets" class="hidden" style="margin-top: 1rem;">
                            <div class="info-box visible" style="margin-bottom: 1rem;">
                                <strong>Custom Storage Subnets</strong>
                                <p style="margin-top: 0.5rem; font-size: 0.9rem;">Specify the storage subnets to use for Storage Network configuration. Enter subnets in CIDR notation (e.g., 10.0.1.0/24).</p>
                            </div>
                            <div id="custom-storage-subnet-inputs" style="display: flex; flex-direction: column; gap: 0.75rem;"></div>
                            <div style="margin-top: 1rem; display: flex; align-items: center; gap: 1rem;">
                                <button type="button" id="custom-storage-subnets-confirm-btn" class="confirm-port-config-btn">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"></polyline></svg>
                                    Confirm Storage Subnets
                                </button>
                                <span id="custom-storage-subnets-confirm-status" style="font-size: 0.85rem; color: var(--text-secondary);">Not confirmed yet.</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Step 7: Outbound Connectivity -->
                <section class="step" id="step-7">
                    <div class="step-header">
                        <span class="step-number">09</span>
                        <h2>Outbound Connectivity</h2>
                        <button type="button" onclick="event.stopPropagation(); showComparison('outbound');" style="margin-left: auto; padding: 6px 12px; background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); color: var(--accent-blue); border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                            Compare Options
                        </button>
                    </div>
                    <p style="margin: 0 0 16px 0; color: var(--text-secondary); font-size: 14px;">
                        <a href="https://learn.microsoft.com/azure/azure-local/concepts/firewall-requirements" target="_blank" rel="noopener noreferrer" style="color: var(--accent-blue); text-decoration: none; font-weight: 500;">
                            üîí More information on Firewall and required endpoints
                        </a>
                    </p>
                    <!-- Connected Options -->
                    <div id="outbound-connected" class="options-grid">
                        <div class="option-card" data-value="public" onclick="selectOption('outbound', 'public')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <circle cx="12" cy="12" r="10" stroke-width="1.5" />
                                    <path d="M2 12H22" stroke-width="1.5" />
                                    <path
                                        d="M12 2C14.5013 4.73835 15.9228 8.29203 16 12C15.9228 15.708 14.5013 19.2616 12 22C9.49872 19.2616 8.07725 15.708 8 12C8.07725 8.29203 9.49872 4.73835 12 2Z"
                                        stroke-width="1.5" />
                                </svg>
                            </div>
                            <h3>Public Internet</h3>
                            <p>Direct connectivity to cloud endpoints.</p>
                        </div>
                        <!-- PRIVATE-PATH-PREVIEW: Remove this comment and the coming-soon-badge span when Private Path is GA -->
                        <div class="option-card" data-value="private" onclick="selectOption('outbound', 'private')">
                            <span class="coming-soon-badge private-path-preview">Coming Soon</span>
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M4 12L20 12" stroke-width="1.5" />
                                    <rect x="2" y="6" width="4" height="12" fill="currentColor" fill-opacity="0.2" />
                                    <rect x="18" y="6" width="4" height="12" fill="currentColor" fill-opacity="0.2" />
                                    <path d="M12 2v20" stroke-dasharray="4 4" opacity="0.5" />
                                </svg>
                            </div>
                            <h3>ExpressRoute / VPN</h3>
                            <p>Private connectivity.</p>
                            <p class="preview-note private-path-preview">‚ö†Ô∏è Feature not available yet</p>
                        </div>
                    </div>

                    <!-- Disconnected Options -->
                    <div id="outbound-disconnected" class="options-grid hidden">
                        <div class="option-card" data-value="air_gapped"
                            onclick="selectOption('outbound', 'air_gapped')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <circle cx="12" cy="12" r="10" stroke-width="1.5" />
                                    <path d="M4.93 4.93L19.07 19.07" stroke-width="1.5" />
                                </svg>
                            </div>
                            <h3>Air Gapped</h3>
                            <p>No internet connectivity.</p>
                        </div>
                        <div class="option-card" data-value="limited" onclick="selectOption('outbound', 'limited')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <circle cx="12" cy="12" r="10" stroke-width="1.5" />
                                    <path d="M12 8v4" stroke-width="2" />
                                    <path d="M12 16h.01" stroke-width="3" />
                                </svg>
                            </div>
                            <h3>Limited Connectivity</h3>
                            <p>Restricted access.</p>
                        </div>
                    </div>
                </section>

                <!-- Step 8: Arc Gateway -->
                <section class="step" id="step-8">
                    <div class="step-header">
                        <span class="step-number">10</span>
                        <h2>Arc Gateway</h2>
                        <div style="margin-left: auto; display: flex; gap: 8px;">
                            <a href="docs/outbound-connectivity/index.html" target="_blank" rel="noopener noreferrer" style="padding: 6px 12px; background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); color: var(--success); border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600; text-decoration: none; display: flex; align-items: center; gap: 4px;">
                                üìò Connectivity Guide
                            </a>
                            <button type="button" onclick="event.stopPropagation(); showComparison('arc');" style="padding: 6px 12px; background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); color: var(--accent-blue); border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                Compare Options
                            </button>
                        </div>
                    </div>
                    <div class="options-grid">
                        <div class="option-card" data-value="arc_gateway" onclick="selectOption('arc', 'arc_gateway')">
                            <div class="badge-recommended">Recommended</div>
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <circle cx="12" cy="12" r="9" stroke-width="1.5" />
                                    <path d="M12 8v8M8 12h8" stroke-width="1.5" />
                                </svg>
                            </div>
                            <h3>Enabled</h3>
                            <p>Arc Gateway Service.</p>
                        </div>
                        <div class="option-card" data-value="no_arc" onclick="selectOption('arc', 'no_arc')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <circle cx="12" cy="12" r="9" stroke-width="1.5" />
                                    <path d="M8 12h8" stroke-width="1.5" />
                                </svg>
                            </div>
                            <h3>Disabled</h3>
                            <p>No Gateway.</p>
                        </div>
                    </div>
                    <div id="arc-explanation" class="info-box"></div>
                </section>

                <!-- Step 9: Proxy Configuration -->
                <section class="step" id="step-9">
                    <div class="step-header">
                        <span class="step-number">11</span>
                        <h2>Proxy Configuration</h2>
                    </div>
                    <div class="options-grid">
                        <!-- Added ID to proxy card for dynamic text updates -->
                        <div id="proxy-enabled-card" class="option-card" data-value="proxy"
                            onclick="selectOption('proxy', 'proxy')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <rect x="2" y="2" width="20" height="20" rx="2" ry="2"></rect>
                                    <path d="M12 2v20"></path>
                                    <path d="M2 12h20"></path>
                                    <path d="M12 12l5-5"></path>
                                </svg>
                            </div>
                            <h3>Enabled</h3>
                            <p id="proxy-enabled-text">Traffic routed through proxy.</p>
                        </div>
                        <div class="option-card" data-value="no_proxy" onclick="selectOption('proxy', 'no_proxy')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <line x1="4.93" y1="4.93" x2="19.07" y2="19.07"></line>
                                </svg>
                            </div>
                            <h3>Disabled</h3>
                            <p>No Proxy.</p>
                        </div>
                    </div>
                    <div id="proxy-warning" class="info-box warning hidden" style="margin-top:1.5rem;">
                        <strong style="color:#ffc107;">‚ö† Important</strong>
                        <p>Proxy server cannot use .local FQDN and the IP address cannot be on AKS reserved subnets
                            10.96.0.0/12 or 10.244.0.0/16.
                            <br><a
                                href="https://learn.microsoft.com/en-us/azure/azure-arc/resource-bridge/network-requirements#designated-ip-ranges-for-arc-resource-bridge"
                                target="_blank" style="color:var(--accent-blue); text-decoration:underline;">Read
                                documentation</a>
                        </p>
                        <p>Azure Local doesn't support HTTPS inspection. Make sure that HTTPS inspection is disabled along your networking path for Azure Local required endpoints to prevent any connectivity errors. This includes use of Entra ID tenant restrictions v1 which isn't supported for Azure Local management network communication.
                            <br><a href="https://learn.microsoft.com/en-us/azure/azure-local/concepts/firewall-requirements?view=azloc-2511" target="_blank" style="color:var(--accent-blue); text-decoration:underline;">Review the required firewall endpoints</a>
                        </p>
                    </div>
                </section>

                <!-- Step 9b: Private Endpoints -->
                <section class="step" id="step-9b">
                    <div class="step-header">
                        <span class="step-number">12</span>
                        <h2>Private Endpoints</h2>
                    </div>
                    <p style="margin: 0 0 16px 0; color: var(--text-secondary); font-size: 14px;">
                        <a href="docs/outbound-connectivity/index.html#private-endpoints" target="_blank" rel="noopener noreferrer" style="color: var(--accent-blue); text-decoration: none; font-weight: 500;">
                            üìò Learn about Private Endpoints in Azure Local
                        </a>
                    </p>
                    <div class="options-grid">
                        <div class="option-card" data-value="pe_enabled" onclick="selectOption('privateEndpoints', 'pe_enabled')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" stroke-width="1.5" />
                                    <path d="M9 12l2 2 4-4" stroke-width="1.5" />
                                </svg>
                            </div>
                            <h3>Enabled</h3>
                            <p>Use Private Link for Azure services.</p>
                        </div>
                        <div class="option-card" data-value="pe_disabled" onclick="selectOption('privateEndpoints', 'pe_disabled')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <circle cx="12" cy="12" r="10" stroke-width="1.5"></circle>
                                    <line x1="4.93" y1="4.93" x2="19.07" y2="19.07" stroke-width="1.5"></line>
                                </svg>
                            </div>
                            <h3>Disabled</h3>
                            <p>No Private Endpoints.</p>
                        </div>
                    </div>

                    <div id="private-endpoints-selection" class="hidden" style="margin-top: 1.5rem;">
                        <h4 style="margin-bottom: 1rem; color: var(--text-primary);">Select Azure Services for Private Endpoints</h4>
                        <p style="margin-bottom: 1rem; color: var(--text-secondary); font-size: 0.9rem;">Choose which Azure services should use Private Link endpoints. These FQDNs will be added to your proxy bypass list.</p>

                        <div class="private-endpoints-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 12px;">
                            <!-- Arc Private Link (Not Supported) -->
                            <div class="pe-service-card disabled" style="display: flex; align-items: flex-start; padding: 1rem; background: rgba(239, 68, 68, 0.15); border: 1px solid rgba(239, 68, 68, 0.4); border-radius: 8px; cursor: not-allowed;">
                                <input type="checkbox" disabled style="margin-right: 12px; margin-top: 2px; pointer-events: none;">
                                <div style="pointer-events: none;">
                                    <strong style="color: var(--text-primary);">üîó Arc Private Link Endpoint</strong>
                                    <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 4px;"><code>his.arc.azure.com</code></div>
                                    <div style="font-size: 0.8rem; color: #ef4444; margin-top: 4px;">üö´ Not supported for Azure Local</div>
                                </div>
                            </div>

                            <!-- Key Vault -->
                            <div class="pe-service-card" onclick="togglePeCheckbox('pe-keyvault')" style="display: flex; align-items: flex-start; padding: 1rem; background: rgba(255, 255, 255, 0.03); border: 1px solid var(--glass-border); border-radius: 8px; cursor: pointer;">
                                <input type="checkbox" id="pe-keyvault" name="pe-service" value="keyvault" onchange="updatePrivateEndpointsList()" style="margin-right: 12px; margin-top: 2px; pointer-events: none;">
                                <div style="pointer-events: none;">
                                    <strong style="color: var(--text-primary);">üîê Azure Key Vault</strong>
                                    <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 4px;"><code>vault.azure.net</code></div>
                                    <div style="font-size: 0.8rem; color: var(--warning); margin-top: 4px;">‚ö†Ô∏è Keep public access during deployment</div>
                                </div>
                            </div>

                            <!-- Storage Blob -->
                            <div class="pe-service-card" onclick="togglePeCheckbox('pe-storage')" style="display: flex; align-items: flex-start; padding: 1rem; background: rgba(255, 255, 255, 0.03); border: 1px solid var(--glass-border); border-radius: 8px; cursor: pointer;">
                                <input type="checkbox" id="pe-storage" name="pe-service" value="storage" onchange="updatePrivateEndpointsList()" style="margin-right: 12px; margin-top: 2px; pointer-events: none;">
                                <div style="pointer-events: none;">
                                    <strong style="color: var(--text-primary);">üíæ Azure Storage (Blob)</strong>
                                    <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 4px;"><code>blob.core.windows.net</code></div>
                                    <div style="font-size: 0.8rem; color: var(--warning); margin-top: 4px;">‚ö†Ô∏è Required for 2-node cloud witness</div>
                                </div>
                            </div>

                            <!-- Azure Container Registry -->
                            <div class="pe-service-card" onclick="togglePeCheckbox('pe-acr')" style="display: flex; align-items: flex-start; padding: 1rem; background: rgba(255, 255, 255, 0.03); border: 1px solid var(--glass-border); border-radius: 8px; cursor: pointer;">
                                <input type="checkbox" id="pe-acr" name="pe-service" value="acr" onchange="updatePrivateEndpointsList()" style="margin-right: 12px; margin-top: 2px; pointer-events: none;">
                                <div style="pointer-events: none;">
                                    <strong style="color: var(--text-primary);">üì¶ Azure Container Registry</strong>
                                    <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 4px;"><code>azurecr.io</code></div>
                                    <div style="font-size: 0.8rem; color: var(--warning); margin-top: 4px;">‚ö†Ô∏è No wildcards - use specific ACR FQDNs</div>
                                </div>
                            </div>

                            <!-- Azure Site Recovery -->
                            <div class="pe-service-card" onclick="togglePeCheckbox('pe-asr')" style="display: flex; align-items: flex-start; padding: 1rem; background: rgba(255, 255, 255, 0.03); border: 1px solid var(--glass-border); border-radius: 8px; cursor: pointer;">
                                <input type="checkbox" id="pe-asr" name="pe-service" value="asr" onchange="updatePrivateEndpointsList()" style="margin-right: 12px; margin-top: 2px; pointer-events: none;">
                                <div style="pointer-events: none;">
                                    <strong style="color: var(--text-primary);">üîÑ Azure Site Recovery</strong>
                                    <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 4px;"><code>siterecovery.windowsazure.com</code></div>
                                    <div style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 4px;">Not allowed via Arc Gateway</div>
                                </div>
                            </div>

                            <!-- Recovery Services Vault -->
                            <div class="pe-service-card" onclick="togglePeCheckbox('pe-backup')" style="display: flex; align-items: flex-start; padding: 1rem; background: rgba(255, 255, 255, 0.03); border: 1px solid var(--glass-border); border-radius: 8px; cursor: pointer;">
                                <input type="checkbox" id="pe-backup" name="pe-service" value="backup" onchange="updatePrivateEndpointsList()" style="margin-right: 12px; margin-top: 2px; pointer-events: none;">
                                <div style="pointer-events: none;">
                                    <strong style="color: var(--text-primary);">üóÑÔ∏è Recovery Services Vault</strong>
                                    <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 4px;"><code>backup.windowsazure.com</code></div>
                                    <div style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 4px;">Azure Backup private endpoints</div>
                                </div>
                            </div>

                            <!-- SQL Managed Instance -->
                            <div class="pe-service-card" onclick="togglePeCheckbox('pe-sql')" style="display: flex; align-items: flex-start; padding: 1rem; background: rgba(255, 255, 255, 0.03); border: 1px solid var(--glass-border); border-radius: 8px; cursor: pointer;">
                                <input type="checkbox" id="pe-sql" name="pe-service" value="sql" onchange="updatePrivateEndpointsList()" style="margin-right: 12px; margin-top: 2px; pointer-events: none;">
                                <div style="pointer-events: none;">
                                    <strong style="color: var(--text-primary);">üóÉÔ∏è SQL Managed Instance</strong>
                                    <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 4px;"><code>database.windows.net</code></div>
                                    <div style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 4px;">Private connectivity for SQL MI</div>
                                </div>
                            </div>

                            <!-- Microsoft Defender for Cloud -->
                            <div class="pe-service-card" onclick="togglePeCheckbox('pe-defender')" style="display: flex; align-items: flex-start; padding: 1rem; background: rgba(255, 255, 255, 0.03); border: 1px solid var(--glass-border); border-radius: 8px; cursor: pointer;">
                                <input type="checkbox" id="pe-defender" name="pe-service" value="defender" onchange="updatePrivateEndpointsList()" style="margin-right: 12px; margin-top: 2px; pointer-events: none;">
                                <div style="pointer-events: none;">
                                    <strong style="color: var(--text-primary);">üõ°Ô∏è Microsoft Defender for Cloud</strong>
                                    <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 4px;">Security monitoring endpoints</div>
                                    <div style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 4px;">For advanced security scenarios</div>
                                </div>
                            </div>
                        </div>

                        <div id="pe-selection-summary" class="hidden" style="margin-top: 1rem; padding: 1rem; background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 8px;">
                            <strong style="color: var(--success);">Selected Services:</strong>
                            <span id="pe-selection-count">0</span> service(s) selected
                        </div>
                    </div>

                    <div id="private-endpoints-info" class="info-box hidden" style="margin-top: 1.5rem;">
                        <strong style="color: var(--accent-blue);">‚ÑπÔ∏è Private Endpoints Configuration</strong>
                        <p style="margin-top: 0.5rem;">Private Endpoints (Private Link) work identically in both Public Path and Private Path architectures:</p>
                        <ul style="margin: 0.5rem 0 0 1.5rem;">
                            <li>Add Private Link endpoint FQDNs to the <strong>proxy bypass list</strong></li>
                            <li>Configure DNS to resolve Private Link FQDNs to private IPs</li>
                            <li>Traffic flows directly to Private Endpoints without going through proxy or Arc Gateway</li>
                        </ul>
                    </div>
                </section>

                <!-- Step 10: Management Connectivity -->
                <section class="step" id="step-10">
                    <div class="step-header">
                        <span class="step-number">13</span>
                        <h2>Management Connectivity</h2>
                    </div>

                    <div class="sub-step">
                        <h4>Nodes and Cluster IP Assignment</h4>
                        <div class="options-grid">
                            <div class="option-card" data-value="static" onclick="selectOption('ip', 'static')">
                                <div class="icon">
                                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <rect x="2" y="4" width="20" height="16" rx="2" />
                                    </svg>
                                </div>
                                <h3>Static IP</h3>
                            </div>
                            <div class="option-card" data-value="dhcp" onclick="selectOption('ip', 'dhcp')">
                                <div class="icon">
                                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <path
                                            d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z">
                                        </path>
                                    </svg>
                                </div>
                                <h3>DHCP</h3>
                            </div>
                        </div>
                        <div id="dhcp-warning" class="info-box warning hidden" style="margin-top:1.5rem;">
                            <strong style="color:#ffc107;">‚ö† Important</strong>
                            <p>DHCP reservations must be configured to ensure the cluster nodes always get the same IP
                                address. It is not supported to change IP address of the nodes.</p>
                        </div>
                    </div>

                    <div id="node-config-section" class="sub-step hidden">
                        <h4>Node Names and IPs</h4>
                        <p style="margin-top:0.5rem; color:var(--text-secondary); font-size:0.9rem;">Provide one node name and one node IP (CIDR format) per node. Names must be NetBIOS-compatible (max 15 characters). Node IPs must be unique.</p>
                        <div id="node-config-container"></div>

                        <div id="node-config-error" class="hidden"
                            style="margin-top:1rem; color:#ef4444; font-size:0.9rem; background:rgba(239,68,68,0.1); padding:0.75rem; border-radius:4px; border:1px solid rgba(239,68,68,0.2);">
                        </div>
                        <div id="node-config-success" class="hidden"
                            style="margin-top:1rem; color:var(--success); font-size:0.9rem;">‚úì Node settings valid</div>
                    </div>
                </section>

                <!-- Step 11: Infrastructure VLAN -->
                <section class="step" id="step-11">
                    <div class="step-header">
                        <span class="step-number">14</span>
                        <h2>Infrastructure VLAN</h2>
                    </div>
                    <div class="options-grid" style="display:block;">
                        <div class="options-grid" style="margin-bottom:1rem;">
                            <div class="option-card" data-value="default" onclick="selectOption('infraVlan', 'default')">
                                <div class="icon">
                                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <circle cx="12" cy="12" r="10" stroke-width="1.5" />
                                        <path d="M8 12h8" stroke-width="2" />
                                        <path d="M12 8v8" stroke-width="2" />
                                    </svg>
                                </div>
                                <h3>Default VLAN</h3>
                                <p>Use the default VLAN (typically ID 0).</p>
                            </div>
                            <div class="option-card" data-value="custom" onclick="selectOption('infraVlan', 'custom')">
                                <div class="icon">
                                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <rect x="4" y="4" width="16" height="16" rx="2" stroke-width="1.5" />
                                        <path d="M8 8h8v8H8z" stroke-width="1.5" />
                                    </svg>
                                </div>
                                <h3>Custom VLAN</h3>
                                <p>Apply a specific management VLAN.</p>
                            </div>
                        </div>
                        <div id="infra-vlan-info" class="info-box hidden" style="margin-bottom:1rem;">
                            <strong style="color:var(--accent-blue);">How to configure management VLAN</strong>
                            <p>We recommend that the management subnet of your Azure Local instance use the default VLAN, which in most cases is declared as VLAN ID 0. However, if your network requirements are to use a specific management VLAN for your infrastructure network, it must be configured on your physical network adapters that you plan to use for management traffic.<br><br>If you plan to use two physical network adapters for management, you need to set the VLAN on both adapters. This must be done as part of the bootstrap configuration of your machines, and before they're registered to Azure Arc, to ensure you successfully register the nodes using this VLAN.
                                <br><a href="https://learn.microsoft.com/en-us/azure/azure-local/plan/cloud-deployment-network-considerations?view=azloc-2511#management-vlan-id" target="_blank" style="color:var(--accent-blue); text-decoration:underline;">Read the VLAN guidance</a>
                            </p>
                        </div>
                        <div id="infra-vlan-custom" class="hidden" style="margin-bottom:1rem;">
                            <label for="infra-vlan-id" style="display:block; margin-bottom:0.5rem; font-size:0.9rem;">Custom VLAN ID (1-4096)</label>
                            <input type="number" id="infra-vlan-id" min="1" max="4096" placeholder="e.g. 181" style="width:100%; padding:0.75rem; background:var(--subtle-bg); border:1px solid var(--glass-border); color:var(--text-primary); border-radius:4px;" onchange="updateInfraVlanId()">
                            <p style="margin-top:0.5rem; color:var(--text-secondary); font-size:0.9rem;">Enter the VLAN ID configured on all management adapters before Azure Arc registration.</p>
                        </div>
                    </div>
                </section>

                <!-- Step 12: Infrastructure Network -->
                <section class="step" id="step-12">
                    <div class="step-header">
                        <span class="step-number">15</span>
                        <h2>Infrastructure Network</h2>
                    </div>
                    <div class="options-grid" style="display:block;">
                        <div id="infra-warning-note" class="info-box warning hidden" style="margin-bottom:1rem;">
                            <strong style="color:#ffc107;">‚ö† Important</strong>
                            <p>Cluster nodes must have IPs on this infrastructure network CIDR and cannot be within the
                                reserved infrastructure IP range that you will define below. The Azure Local Infrastructure network cannot overlap with any of the AKS reserved networks required by Arc Resource Bridge (10.96.0.0/12 and 10.244.0.0/16).</p>
                        </div>
                        <div style="margin-bottom:1rem;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom:0.5rem;">
                                <label style="display:block; font-size:0.9rem;">Infrastructure Network (CIDR)</label>
                                <button type="button" onclick="showCidrCalculator()" style="padding: 6px 12px; background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); color: var(--accent-blue); border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600; transition: all 0.2s;">
                                    üî¢ Subnet Calculator
                                </button>
                            </div>
                            <input type="text" id="infra-cidr" placeholder="e.g. 192.168.1.0/24"
                                title="Enter a valid IPv4 CIDR (e.g. 192.168.1.0/24)"
                                style="width:100%; padding:0.75rem; background:var(--subtle-bg); border:1px solid var(--glass-border); color:var(--text-primary); border-radius:4px;"
                                oninput="markInfraCidrManual(this.value)"
                                onchange="updateInfraNetwork()">
                            <h5 style="margin-top:0.75rem; color:var(--text-primary); font-size:1rem;">Infrastructure Network IP Pool</h5>
                            <p style="margin-top:0.5rem; color:var(--text-secondary); font-size:0.9rem;">Define the IP
                                range for infrastructure components (min 6 consecutive IPs). Cluster IP, ARB VM, SDN Network Controller and other infrastructure services will use IPs out of this IP Pool range.</p>
                        </div>
                        <div style="display:flex; gap:1rem; flex-wrap:wrap;">
                            <div style="flex:1; min-width:200px;">
                                <label style="display:block; margin-bottom:0.5rem; font-size:0.9rem;">Starting
                                    IP</label>
                                <input type="text" id="infra-ip-start" placeholder="e.g. 192.168.1.10"
                                    pattern="^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$"
                                    title="Enter a valid IPv4 address (e.g. 192.168.1.10)"
                                    style="width:100%; padding:0.75rem; background:var(--subtle-bg); border:1px solid var(--glass-border); color:var(--text-primary); border-radius:4px;"
                                    onchange="updateInfraNetwork()">
                            </div>
                            <div style="flex:1; min-width:200px;">
                                <label style="display:block; margin-bottom:0.5rem; font-size:0.9rem;">Ending IP</label>
                                <input type="text" id="infra-ip-end" placeholder="e.g. 192.168.1.15"
                                    pattern="^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$"
                                    title="Enter a valid IPv4 address (e.g. 192.168.1.15)"
                                    style="width:100%; padding:0.75rem; background:var(--subtle-bg); border:1px solid var(--glass-border); color:var(--text-primary); border-radius:4px;"
                                    onchange="updateInfraNetwork()">
                            </div>
                        </div>

                        <div style="margin-top:1rem;">
                            <label style="display:block; margin-bottom:0.5rem; font-size:0.9rem;">Default Gateway</label>
                            <input type="text" id="infra-default-gateway" placeholder="e.g. 192.168.1.1"
                                pattern="^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$"
                                title="Enter a valid IPv4 address (e.g. 192.168.1.1)"
                                style="width:100%; padding:0.75rem; background:var(--subtle-bg); border:1px solid var(--glass-border); color:var(--text-primary); border-radius:4px;"
                                oninput="markInfraGatewayManual(this.value)"
                                onchange="updateInfraNetwork()">
                            <p style="margin-top:0.5rem; color:var(--text-secondary); font-size:0.9rem;">Must be in the Infrastructure Network CIDR and outside the reserved Infrastructure IP Pool.</p>
                        </div>
                        <div id="infra-ip-error" class="hidden"
                            style="margin-top:1rem; color:#ef4444; font-size:0.9rem; background:rgba(239,68,68,0.1); padding:0.75rem; border-radius:4px; border:1px solid rgba(239,68,68,0.2);">
                        </div>
                        <div id="infra-ip-success" class="hidden"
                            style="margin-top:1rem; color:var(--success); font-size:0.9rem;">‚úì Valid Range</div>

                        <div id="infra-gateway-error" class="hidden"
                            style="margin-top:1rem; color:#ef4444; font-size:0.9rem; background:rgba(239,68,68,0.1); padding:0.75rem; border-radius:4px; border:1px solid rgba(239,68,68,0.2);">
                        </div>
                        <div id="infra-gateway-success" class="hidden"
                            style="margin-top:1rem; color:var(--success); font-size:0.9rem;">‚úì Valid Default Gateway</div>
                    </div>
                </section>

                <!-- Step 5.5: Storage Pool Configuration -->
                <section class="step" id="step-5-5">
                    <div class="step-header">
                        <span class="step-number">16</span>
                        <h2>Storage Pool Configuration</h2>
                    </div>
                    <div class="options-grid">
                        <div class="option-card" data-value="Express"
                            onclick="selectOption('storagePoolConfiguration', 'Express')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M13 2L3 14h8l-1 8 10-12h-8l1-8z" stroke-width="1.5" fill="rgba(0, 120, 212, 0.1)" />
                                </svg>
                            </div>
                            <h3>Express</h3>
                            <p>Create one UserStorage volume per physical machine</p>
                        </div>
                        <div class="option-card" data-value="InfraOnly"
                            onclick="selectOption('storagePoolConfiguration', 'InfraOnly')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <rect x="3" y="4" width="18" height="16" rx="2" stroke-width="1.5" fill="rgba(139, 92, 246, 0.1)" />
                                    <path d="M3 10h18M7 4v16M17 4v16" stroke-width="1.5" />
                                </svg>
                            </div>
                            <h3>InfraOnly</h3>
                            <p>Create only the Infrastructure volume, no storage volumes for workload</p>
                        </div>
                        <div class="option-card" data-value="KeepStorage"
                            onclick="selectOption('storagePoolConfiguration', 'KeepStorage')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <circle cx="12" cy="12" r="9" stroke-width="1.5" fill="rgba(16, 185, 129, 0.1)" />
                                    <path d="M9 12l2 2 4-4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                </svg>
                            </div>
                            <h3>KeepStorage</h3>
                            <p>Retain the existing volumes present on the data disks of the physical machines</p>
                        </div>
                    </div>
                </section>

                <!-- Step 13: Active Directory -->
                <section class="step" id="step-13">
                    <div class="step-header">
                        <span class="step-number">17</span>
                        <h2>Active Directory</h2>
                    </div>
                    <div class="options-grid">
                        <div class="option-card" data-value="azure_ad"
                            onclick="selectOption('activeDirectory', 'azure_ad')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z"
                                        stroke-width="1.5" />
                                    <path d="M12 12h.01" stroke-width="2" stroke-linecap="round" />
                                </svg>
                            </div>
                            <h3>Active Directory Domain Services (AD) for Identity</h3>
                            <p>Domain-joined with AD integration.</p>
                        </div>
                        <div class="option-card" id="ad-local-identity-card" data-value="local_identity"
                            onclick="selectOption('activeDirectory', 'local_identity')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <circle cx="12" cy="12" r="10" stroke-width="1.5" />
                                    <path d="M12 6v6l4 2" stroke-width="1.5" />
                                </svg>
                            </div>
                            <h3>Azure KeyVault for Identity (AD-Less)</h3>
                            <p>Local identity provider.</p>
                        </div>
                    </div>

                    <div id="ad-domain-section" class="hidden"
                        style="margin-top:1.5rem; padding-top:1.25rem; border-top:1px solid var(--glass-border);">
                        <label style="display:block; margin-bottom:0.5rem; font-size:0.9rem;">Active Directory Domain
                            Name</label>
                        <input type="text" id="ad-domain" placeholder="e.g. contoso.com"
                            style="width:100%; padding:0.75rem; background:var(--subtle-bg); border:1px solid var(--glass-border); color:var(--text-primary); border-radius:4px;"
                            onchange="updateAdDomain()">

                        <div style="margin-top:1.5rem;">
                            <label style="display:block; margin-bottom:0.5rem; font-size:0.9rem;">
                                AD OU Path
                                <span style="color:var(--text-secondary); font-size:0.85rem; margin-left:0.5rem;" title="Active Directory Organization Unit Path, example: 'OU=Cluster1,OU=AzureLocal,DC=contoso,DC=com'. It is recommended that this OU is created using the AD Preparation tool">‚ÑπÔ∏è</span>
                            </label>
                            <input type="text" id="ad-ou-path" placeholder="e.g. OU=Cluster1,OU=AzureLocal,DC=contoso,DC=com"
                                style="width:100%; padding:0.75rem; background:var(--subtle-bg); border:1px solid var(--glass-border); color:var(--text-primary); border-radius:4px;"
                                onchange="updateAdOuPath()">
                            <div style="margin-top:0.5rem; font-size:0.85rem; color:var(--text-secondary);">
                                It is recommended that this OU is created using the <a href="https://learn.microsoft.com/azure/azure-local/deploy/deployment-prep-active-directory#active-directory-preparation-module" target="_blank" style="color:var(--accent-blue);">AD Preparation tool</a>
                            </div>
                            <div id="ad-ou-path-error" class="hidden"
                                style="margin-top:0.5rem; color:#ef4444; font-size:0.85rem; background:rgba(239,68,68,0.1); padding:0.5rem; border-radius:4px; border:1px solid rgba(239,68,68,0.2);">
                            </div>
                        </div>

                        <div id="adfs-server-section" class="hidden" style="margin-top:1.5rem;">
                            <label style="display:block; margin-bottom:0.5rem; font-size:0.9rem;">
                                ADFS Server Name
                                <span style="color:var(--text-secondary); font-size:0.85rem; margin-left:0.5rem;" title="Active Directory Federation Services server name for disconnected deployments">‚ÑπÔ∏è</span>
                            </label>
                            <input type="text" id="adfs-server-name" placeholder="e.g. adfs.contoso.com"
                                style="width:100%; padding:0.75rem; background:var(--subtle-bg); border:1px solid var(--glass-border); color:var(--text-primary); border-radius:4px;"
                                onchange="updateAdfsServerName()">
                            <div style="margin-top:0.5rem; font-size:0.85rem; color:var(--text-secondary);">
                                Required for disconnected deployments with Active Directory Federation Services
                            </div>
                        </div>
                    </div>

                    <!-- DNS Configuration -->
                    <div id="dns-config-section" class="hidden"
                        style="margin-top:2rem; padding-top:1.5rem; border-top:1px solid var(--glass-border);">
                        <h4 id="dns-config-title"
                            style="color:var(--accent-purple); font-size:1.2rem; margin-bottom:1rem;">DNS Configuration
                        </h4>

                        <!-- Local DNS Zone (only for local_identity) -->
                        <div id="local-dns-zone" class="hidden" style="margin-top:1.5rem;">
                            <h4 style="color:var(--accent-purple); font-size:1.2rem; margin-bottom:1rem;">DNS Service</h4>

                            <div style="margin-bottom:1.25rem;">
                                <label style="display:block; margin-bottom:0.5rem; font-size:0.9rem;">
                                    Zone name <span style="color:#ef4444;">*</span>
                                </label>
                                <input type="text" id="local-dns-zone-input" placeholder=""
                                    style="width:100%; padding:0.75rem; background:var(--subtle-bg); border:1px solid var(--glass-border); color:var(--text-primary); border-radius:4px;"
                                    onchange="updateLocalDnsZone()">
                            </div>

                            <div style="margin-bottom:1rem;">
                                <div style="margin-bottom:0.5rem; font-size:0.9rem;">Do you have an existing DNS Service?</div>
                                <label style="display:flex; align-items:center; gap:0.5rem; margin-bottom:0.35rem; color:var(--text-secondary);">
                                    <input type="radio" name="dns-service-existing" value="yes" checked
                                        onchange="updateDnsServiceExisting(this.value)">
                                    Yes
                                </label>
                                <label style="display:flex; align-items:center; gap:0.5rem; color:var(--text-secondary);">
                                    <input type="radio" name="dns-service-existing" value="no"
                                        onchange="updateDnsServiceExisting(this.value)">
                                    No
                                </label>

                                <div id="dns-service-existing-note" class="switchless-diagram__note" style="margin-top:0.75rem;">
                                    If <strong style="color:var(--text-primary);">No</strong> is selected, a Local DNS Server will be installed on the nodes and configured to use the DNS server as a forwarder to resolve external names.
                                    If <strong style="color:var(--text-primary);">Yes</strong> is selected, an external DNS server is already configured and there is no need to deploy a Local DNS server on Azure Local nodes.
                                </div>
                            </div>
                        </div>

                        <div id="dns-servers-container"></div>

                        <button onclick="addDnsServer()"
                            style="margin-top:1rem; padding:0.5rem 1rem; background:rgba(0,120,212,0.2); border:1px solid var(--accent-blue); color:var(--accent-blue); border-radius:4px; cursor:pointer; font-size:0.9rem;">
                            + Add DNS server
                        </button>

                        <!-- DNS Warning -->
                        <div class="info-box warning visible" style="margin-top:1.5rem;">
                            <strong style="color:#ffc107;">‚ö† Important</strong>
                            <p>DNS servers cannot be changed after deployment. Ensure the configuration is correct
                                before proceeding.</p>
                        </div>

                        <!-- DNS Validation Messages -->
                        <div id="dns-error" class="hidden"
                            style="margin-top:1rem; color:#ef4444; font-size:0.9rem; background:rgba(239,68,68,0.1); padding:0.75rem; border-radius:4px; border:1px solid rgba(239,68,68,0.2);">
                        </div>
                        <div id="dns-success" class="hidden"
                            style="margin-top:1rem; color:var(--success); font-size:0.9rem;">
                        </div>
                    </div>
                </section>

                <!-- Step 13.5: Security Configuration -->
                <section class="step" id="step-13-5">
                    <div class="step-header">
                        <span class="step-number">18</span>
                        <h2>Security Configuration</h2>
                    </div>

                    <p style="margin-bottom:1.5rem; color:var(--text-secondary);">
                        Configure security controls for your Azure Local deployment.
                        <a href="https://learn.microsoft.com/azure/azure-local/concepts/security-features"
                           target="_blank"
                           rel="noopener noreferrer"
                           style="color:var(--accent-blue); text-decoration:none;">
                            More information on security controls ‚Üó
                        </a>
                    </p>

                    <div class="options-grid">
                        <div class="option-card" data-value="recommended"
                            onclick="selectOption('securityConfiguration', 'recommended')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z"
                                        stroke-width="1.5" />
                                    <path d="M9 12l2 2 4-4" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                                </svg>
                            </div>
                            <h3>Recommended</h3>
                            <p>Secure by default configuration of security controls</p>
                        </div>
                        <div class="option-card" data-value="customized"
                            onclick="selectOption('securityConfiguration', 'customized')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z"
                                        stroke-width="1.5" />
                                    <path d="M12 8v8M8 12h8" stroke-width="1.5" stroke-linecap="round" />
                                </svg>
                            </div>
                            <h3>Customized</h3>
                            <p>Customize security controls. Note: it is not recommended to disable security controls.</p>
                        </div>
                    </div>

                    <!-- Custom Security Settings -->
                    <div id="custom-security-section" class="hidden"
                        style="margin-top:1.5rem; padding-top:1.25rem; border-top:1px solid var(--glass-border);">
                        <h4 style="color:var(--accent-purple); font-size:1.2rem; margin-bottom:1rem;">Custom Security Settings</h4>

                        <div style="display:flex; flex-direction:column; gap:1rem;">
                            <div class="security-toggle-item" style="display:flex; justify-content:space-between; align-items:center; padding:0.75rem; background:rgba(255,255,255,0.03); border-radius:6px; border:1px solid var(--glass-border);">
                                <div>
                                    <div style="font-weight:500; margin-bottom:0.25rem;">Drift Control Enforced</div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="updateSecuritySetting('driftControlEnforced', this.checked)">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>

                            <div class="security-toggle-item" style="display:flex; justify-content:space-between; align-items:center; padding:0.75rem; background:rgba(255,255,255,0.03); border-radius:6px; border:1px solid var(--glass-border);">
                                <div>
                                    <div style="font-weight:500; margin-bottom:0.25rem;">Bitlocker Boot Volume</div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="updateSecuritySetting('bitlockerBootVolume', this.checked)">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>

                            <div class="security-toggle-item" style="display:flex; justify-content:space-between; align-items:center; padding:0.75rem; background:rgba(255,255,255,0.03); border-radius:6px; border:1px solid var(--glass-border);">
                                <div>
                                    <div style="font-weight:500; margin-bottom:0.25rem;">Bitlocker Data Volumes</div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="updateSecuritySetting('bitlockerDataVolumes', this.checked)">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>

                            <div class="security-toggle-item" style="display:flex; justify-content:space-between; align-items:center; padding:0.75rem; background:rgba(255,255,255,0.03); border-radius:6px; border:1px solid var(--glass-border);">
                                <div>
                                    <div style="font-weight:500; margin-bottom:0.25rem;">Wdac Enforced</div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="updateSecuritySetting('wdacEnforced', this.checked)">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>

                            <div class="security-toggle-item" style="display:flex; justify-content:space-between; align-items:center; padding:0.75rem; background:rgba(255,255,255,0.03); border-radius:6px; border:1px solid var(--glass-border);">
                                <div>
                                    <div style="font-weight:500; margin-bottom:0.25rem;">Credential Guard Enforced</div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="updateSecuritySetting('credentialGuardEnforced', this.checked)">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>

                            <div class="security-toggle-item" style="display:flex; justify-content:space-between; align-items:center; padding:0.75rem; background:rgba(255,255,255,0.03); border-radius:6px; border:1px solid var(--glass-border);">
                                <div>
                                    <div style="font-weight:500; margin-bottom:0.25rem;">Smb Signing Enforced</div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="updateSecuritySetting('smbSigningEnforced', this.checked)">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>

                            <div class="security-toggle-item" style="display:flex; justify-content:space-between; align-items:center; padding:0.75rem; background:rgba(255,255,255,0.03); border-radius:6px; border:1px solid var(--glass-border);">
                                <div>
                                    <div style="font-weight:500; margin-bottom:0.25rem;">Smb Cluster Encryption</div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="updateSecuritySetting('smbClusterEncryption', this.checked)">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Step 14: Software Defined Networking -->
                <!-- Step 14: Software Defined Networking -->
                <section class="step" id="step-14">
                    <div class="step-header">
                        <span class="step-number">19</span>
                        <h2>Software Defined Networking</h2>
                    </div>

                    <p style="margin-bottom:1.5rem; color:var(--text-secondary);">SDN enables advanced networking capabilities like network virtualization, security groups, and load balancing.</p>

                    <!-- SDN Enabled Selection -->
                    <div class="options-grid" style="margin-bottom:2rem;">
                        <div class="option-card" id="sdn-enabled-yes" data-value="yes"
                            onclick="selectOption('sdnEnabled', 'yes')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" stroke-width="1.5"/>
                                    <polyline points="22 4 12 14.01 9 11.01" stroke-width="1.5"/>
                                </svg>
                            </div>
                            <h3>Enable SDN</h3>
                            <p>Configure Software Defined Networking features for your cluster.</p>
                        </div>

                        <div class="option-card" id="sdn-enabled-no" data-value="no"
                            onclick="selectOption('sdnEnabled', 'no')">
                            <div class="icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <circle cx="12" cy="12" r="10" stroke-width="1.5"/>
                                    <line x1="15" y1="9" x2="9" y2="15" stroke-width="1.5"/>
                                    <line x1="9" y1="9" x2="15" y2="15" stroke-width="1.5"/>
                                </svg>
                            </div>
                            <h3>No SDN</h3>
                            <p>Skip SDN configuration. You can add SDN features later if needed.</p>
                        </div>
                    </div>

                    <!-- SDN Features Section (only shown when SDN is enabled) -->
                    <div id="sdn-features-section" class="hidden">
                        <div style="padding-top:1.5rem; border-top:1px solid var(--glass-border);">
                            <h4 style="color:var(--accent-purple); font-size:1.1rem; margin-bottom:0.75rem;">Select SDN Features</h4>
                            <p style="margin-bottom:1rem; color:var(--text-secondary); font-size:0.9rem;">Choose the SDN features you want to enable (multiple selections allowed):</p>

                            <div id="sdn-features-grid"
                                style="display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:1rem; margin-bottom:2rem;">
                                <label class="sdn-feature-card" data-feature="lnet">
                                    <input type="checkbox" onchange="toggleSdnFeature('lnet', this.checked)"
                                        style="margin-right:0.5rem;">
                                    <span>
                                        <strong>Logical Networks (LNET)</strong>
                                        <span style="display:block; font-size:0.85rem; color:var(--text-secondary); margin:0.25rem 0 0 0;">Network
                                            virtualization</span>
                                    </span>
                                </label>

                                <label class="sdn-feature-card" data-feature="nsg">
                                    <input type="checkbox" onchange="toggleSdnFeature('nsg', this.checked)"
                                        style="margin-right:0.5rem;">
                                    <span>
                                        <strong>Network Security Groups (NSG)</strong>
                                        <span style="display:block; font-size:0.85rem; color:var(--text-secondary); margin:0.25rem 0 0 0;">Traffic
                                            filtering</span>
                                    </span>
                                </label>

                                <label class="sdn-feature-card" data-feature="vnet">
                                    <input type="checkbox" onchange="toggleSdnFeature('vnet', this.checked)"
                                        style="margin-right:0.5rem;">
                                    <span>
                                        <strong>Virtual Networks (VNET)</strong>
                                        <span style="display:block; font-size:0.85rem; color:var(--text-secondary); margin:0.25rem 0 0 0;">
                                            Isolated networks</span>
                                    </span>
                                </label>

                                <label class="sdn-feature-card" data-feature="slb">
                                    <input type="checkbox" onchange="toggleSdnFeature('slb', this.checked)"
                                        style="margin-right:0.5rem;">
                                    <span>
                                        <strong>Load Balancers (SLB)</strong>
                                        <span style="display:block; font-size:0.85rem; color:var(--text-secondary); margin:0.25rem 0 0 0;">Traffic
                                            distribution</span>
                                    </span>
                                </label>
                            </div>
                        </div>

                        <!-- SDN Management Options -->
                        <div id="sdn-management-section" class="hidden"
                            style="margin-top:2rem; padding-top:1.5rem; border-top:1px solid var(--glass-border);">
                            <h4 style="color:var(--accent-purple); font-size:1.2rem; margin-bottom:1rem;">SDN Management
                            </h4>

                            <div class="options-grid">
                                <div class="option-card" id="sdn-arc-card" data-value="arc_managed"
                                    onclick="selectOption('sdnManagement', 'arc_managed')">
                                    <div class="icon">
                                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                            <circle cx="12" cy="12" r="9" stroke-width="1.5" />
                                            <path d="M12 3v18M3 12h18" stroke-width="1.5" />
                                        </svg>
                                    </div>
                                    <h3>SDN Managed by Arc</h3>
                                    <p>Cloud-managed SDN via Azure Arc.</p>
                                </div>

                                <div class="option-card" id="sdn-onprem-card" data-value="onprem_managed"
                                    onclick="selectOption('sdnManagement', 'onprem_managed')">
                                    <div class="icon">
                                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                            <rect x="3" y="3" width="18" height="18" rx="2" stroke-width="1.5" />
                                            <path d="M3 9h18M9 3v18" stroke-width="1.5" />
                                        </svg>
                                    </div>
                                    <h3>SDN Managed by On-Premises Tools</h3>
                                    <p>Managed using on-premises SDN infrastructure.</p>
                                </div>
                            </div>

                            <div id="sdn-info" class="info-box visible" style="margin-top:1.5rem;">
                                <strong>SDN Management Selection</strong>
                                <p id="sdn-info-text">Select SDN features above to see available management options.</p>
                            </div>
                        </div>
                    </div>
                    <!-- End SDN Features Section -->

                    <div style="margin-top:2rem; padding-top:1.5rem; border-top:1px solid var(--glass-border);">
                        <!-- Missing Sections Display -->
                        <div id="missing-sections-container" style="margin-bottom: 1.5rem; display: none;">
                            <div style="padding: 1rem; background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 8px;">
                                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem;">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2">
                                        <circle cx="12" cy="12" r="10"/>
                                        <line x1="12" y1="8" x2="12" y2="12"/>
                                        <line x1="12" y1="16" x2="12.01" y2="16"/>
                                    </svg>
                                    <strong style="color: #ef4444; font-size: 0.9rem;">Complete These Sections:</strong>
                                </div>
                                <div id="missing-sections-list" style="display: flex; flex-direction: column; gap: 0.5rem;">
                                    <!-- Dynamically populated -->
                                </div>
                            </div>
                        </div>

                        <button id="generate-report-btn" type="button" class="report-button" onclick="generateReport()" disabled style="padding: 0.75rem 1.25rem; font-size: 0.9rem;">
                            üìã Generate Cluster Design Document
                        </button>
                        <p style="margin-top:0.75rem; color:var(--text-secondary); font-size:0.85rem; line-height:1.4;">
                            Creates a detailed report explaining your selections and the decision logic behind them.
                        </p>

                        <button id="generate-arm-btn" type="button" class="report-button" onclick="generateArmParameters()" disabled style="margin-top:0.75rem; padding: 0.75rem 1.25rem; font-size: 0.9rem;">
                            üöÄ Generate Cluster ARM Deployment Files
                        </button>
                        <p style="margin-top:0.75rem; color:var(--text-secondary); font-size:0.85rem; line-height:1.4;">
                            Opens a page with Azure ARM parameters JSON, populated from your answers with placeholders for values not collected.
                        </p>
                    </div>
                </section>

            </div> <!-- End steps-column -->

            <div class="summary-column">
                <div id="summary-panel" class="hidden">
                    <div id="wizard-progress" class="wizard-progress" role="region" aria-label="Wizard progress">
                        <div class="wizard-progress__top">
                            <div class="wizard-progress__title">Progress</div>
                            <div id="wizard-progress-text" class="wizard-progress__text">0% ‚Ä¢ 0/0</div>
                        </div>
                        <div class="wizard-progress__bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
                            <div id="wizard-progress-fill" class="wizard-progress__fill" style="width:0%"></div>
                        </div>
                    </div>
                    <div style="margin-top: 8px; display: flex; flex-direction: column; gap: 8px; font-size: 12px; color: var(--text-secondary);">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div style="display: flex; align-items: center; gap: 4px;">
                                <span style="margin-right: 4px;">Font:</span>
                                <button onclick="decreaseFontSize()" title="Decrease font size" style="padding: 4px 8px; background: var(--subtle-bg); border: 1px solid var(--glass-border); color: var(--text-primary); border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: bold;">A‚àí</button>
                                <button onclick="increaseFontSize()" title="Increase font size" style="padding: 4px 8px; background: var(--subtle-bg); border: 1px solid var(--glass-border); color: var(--text-primary); border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: bold;">A+</button>
                            </div>
                        </div>
                    </div>
                    <h3>Configuration Summary</h3>
                    <div id="summary-content"></div>
                    <div id="summary-diagram-container" class="summary-diagram"></div>
                    <div id="mermaid-export-buttons" style="display: flex; gap: 8px; margin-bottom: 12px;">
                        <button onclick="copyMermaidDiagram()" style="flex: 1; padding: 8px 12px; background: rgba(139, 92, 246, 0.1); border: 1px solid rgba(139, 92, 246, 0.3); color: var(--accent-purple); border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: 600; transition: all 0.2s;" title="Copy Mermaid diagram markup to clipboard">
                            üìã Copy Mermaid
                        </button>
                        <button onclick="downloadMermaidDiagram()" style="flex: 1; padding: 8px 12px; background: rgba(139, 92, 246, 0.1); border: 1px solid rgba(139, 92, 246, 0.3); color: var(--accent-purple); border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: 600; transition: all 0.2s;" title="Download diagram as Markdown file with Mermaid code block">
                            ‚¨áÔ∏è Download .md
                        </button>
                    </div>

                    <button onclick="showTemplates()" style="width: 100%; padding: 10px 16px; background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); color: var(--accent-blue); border-radius: 8px; cursor: pointer; font-size: 13px; font-weight: 600; transition: all 0.2s; margin-bottom: 8px;">
                        üìã Load Example Configuration Template
                    </button>

                    <div style="display: flex; gap: 8px; margin-bottom: 12px;">
                        <button onclick="importConfiguration()" style="flex: 1; padding: 10px 16px; background: var(--subtle-bg); border: 1px solid var(--glass-border); color: var(--text-primary); border-radius: 8px; cursor: pointer; font-size: 13px; font-weight: 600; transition: all 0.2s;">
                            üìÅ Import
                        </button>
                        <button onclick="exportConfiguration()" style="flex: 1; padding: 10px 16px; background: var(--subtle-bg); border: 1px solid var(--glass-border); color: var(--text-primary); border-radius: 8px; cursor: pointer; font-size: 13px; font-weight: 600; transition: all 0.2s;">
                            üíæ Export
                        </button>
                    </div>

                    <button onclick="resetAll()" class="reset-button">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" />
                            <path d="M3 3v5h5" />
                        </svg>
                        Start Over
                    </button>
                </div>
            </div>
        </div> <!-- End layout-flex -->

    </main>
    </div> <!-- End Designer Tab Content -->

    <!-- Modular JavaScript files (load before main script.js) -->
    <script src="js/utils.js"></script>
    <script src="js/notifications.js"></script>
    <script src="js/analytics.js"></script>
    <script src="js/theme.js"></script>
    <script src="js/formatting.js"></script>
    <script src="js/validation.js"></script>
    <script src="js/dns.js"></script>
    <script src="js/script.js"></script>
</body>

</html>